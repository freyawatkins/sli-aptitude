---
title: "Sign Language Interpreter Aptitude"
subtitle: "02 - Change over Time Analysis"
author:
  - name: "Freya Watkins"
    affiliation: "University of Birmingham"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 5
    number_sections: false
    theme: flatly
    highlight: haddock
---

# Setup
```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
```

## Load packages
```{r load_packages, message = FALSE, warning = FALSE}
library(here) # file organisation & folder location
library(tidyverse) # data wrangling & plotting
library(PupillometryR) # raincloud plots
library(sdamr) # simultaneously nudge + jitter plot points
library(plotrix) # for calculating standard error
library(scales) # scales on plots
library(lme4) # for linear mixed models
library(afex) # for linear mixed models
library(psych) # for factor analysis
```

### R / package versions used
```{r r_package_versions, message = FALSE, warning = FALSE}
R.Version() 
packageVersion('here')
packageVersion('tidyverse')
packageVersion('PupillometryR')
packageVersion('sdamr')
packageVersion('plotrix') 
packageVersion('scales') 
packageVersion('lme4') 
packageVersion('afex')
packageVersion('psych')
```

## Read pre-wrangled data 
(see `00-wrangling-setup.Rmd` script)
```{r read_in_data}
here::here()
apt <- readRDS(here("data", "apt-data.rds"))
apt <- as_tibble(apt)
head(apt)
```

Filter out participants who did not progress beyond interview
```{r}
apt <- apt %>% filter(selection == "selected")
```

Filter out participants with deaf family members / L1 BSL
```{r}
apt <- apt %>% filter(L1_bsl != 1)
```

# Summary tables

### Dual N-Back
```{r nback_summary}
apt %>% 
  filter(!is.na(nback_lett)) %>% 
  group_by(session) %>% 
  summarise(nback_lett_mean = mean(nback_lett), 
            sd = sd(nback_lett),
            se = std.error(nback_lett))

apt %>% 
  filter(!is.na(nback_spat)) %>% 
  group_by(session) %>% 
  summarise(nback_spat_mean = mean(nback_spat), 
            sd = sd(nback_spat),
            se = std.error(nback_spat))

apt %>% 
  filter(!is.na(nback_comb)) %>% 
  group_by(session) %>% 
  summarise(nback_comb_mean = mean(nback_comb), 
            sd = sd(nback_comb),
            se = std.error(nback_comb))
```

### Corsi Blocks
```{r corsi_summary}
apt %>% 
  filter(!is.na(corsi_bspan)) %>% 
  group_by(session) %>% 
  summarise(corsi_bspan_mean = mean(corsi_bspan), 
            sd = sd(corsi_bspan),
            se = std.error(corsi_bspan))

apt %>% 
  filter(!is.na(corsi_score)) %>% 
  group_by(session) %>% 
  summarise(corsi_score_mean = mean(corsi_score), 
            sd = sd(corsi_score),
            se = std.error(corsi_score))

apt %>% 
  filter(!is.na(corsi_corr)) %>% 
  group_by(session) %>% 
  summarise(corsi_corr_mean = mean(corsi_corr), 
            sd = sd(corsi_corr),
            se = std.error(corsi_corr))

apt %>% 
  filter(!is.na(corsi_mspan)) %>% 
  group_by(session) %>% 
  summarise(corsi_mspan_mean = mean(corsi_mspan), 
            sd = sd(corsi_mspan),
            se = std.error(corsi_mspan))
```

### Kirklees Sentence Reading
```{r kirklees_summary}
apt %>% 
  filter(!is.na(kirk_ceil)) %>% 
  group_by(session) %>% 
  summarise(kirk_ceil_mean = mean(kirk_ceil), 
            sd = sd(kirk_ceil),
            se = std.error(kirk_ceil))

apt %>% 
  filter(!is.na(kirk_raw)) %>% 
  group_by(session) %>% 
  summarise(kirk_raw_mean = mean(kirk_raw), 
            sd = sd(kirk_raw),
            se = std.error(kirk_raw))

apt %>% 
  filter(!is.na(kirk_acc)) %>% 
  group_by(session) %>% 
  summarise(kirk_acc_mean = mean(kirk_acc), 
            sd = sd(kirk_acc),
            se = std.error(kirk_acc))
```

### KBIT-2 Matrices
```{r kbit_summary}
apt %>% 
  filter(!is.na(kbit_ceil)) %>% 
  group_by(session) %>% 
  summarise(kirk_ceil_mean = mean(kbit_ceil), 
            sd = sd(kbit_ceil),
            se = std.error(kbit_ceil))

apt %>% 
  filter(!is.na(kbit_raw)) %>% 
  group_by(session) %>% 
  summarise(kbit_raw_mean = mean(kbit_raw), 
            sd = sd(kbit_raw),
            se = std.error(kbit_raw))

apt %>% 
  filter(!is.na(kbit_acc)) %>% 
  group_by(session) %>% 
  summarise(kbit_acc_mean = mean(kbit_acc), 
            sd = sd(kbit_acc),
            se = std.error(kbit_acc))
```

### Digit Span
```{r dspan_summary}
apt %>% 
  filter(!is.na(dspan_mem)) %>% 
  group_by(session) %>% 
  summarise(dspan_mem_mean = mean(dspan_mem), 
            sd = sd(dspan_mem),
            se = std.error(dspan_mem))

apt %>% 
  filter(!is.na(dspan_corr)) %>% 
  group_by(session) %>% 
  summarise(dspan_corr_mean = mean(dspan_corr), 
            sd = sd(dspan_corr),
            se = std.error(dspan_corr))
```

### 2D Mental Rotation
```{r 2dmr_summary}
apt %>% 
  filter(!is.na(mr2d_acc)) %>% 
  group_by(session) %>% 
  summarise(mr2d_acc_mean = mean(mr2d_acc), 
            sd = sd(mr2d_acc),
            se = std.error(mr2d_acc))

apt %>% 
  filter(!is.na(mr2d_rt)) %>% 
  group_by(session) %>% 
  summarise(mr2d_rt_mean = mean(mr2d_rt), 
            sd = sd(mr2d_rt),
            se = std.error(mr2d_rt))

apt %>% 
  filter(!is.na(mr2d_sats)) %>% 
  group_by(session) %>% 
  summarise(mr2d_sats_mean = mean(mr2d_sats), 
            sd = sd(mr2d_sats),
            se = std.error(mr2d_sats))
```

### 3D Mental Rotation
```{r 3dmr_summary}
apt %>% 
  filter(!is.na(mr3d_acc)) %>% 
  group_by(session) %>% 
  summarise(mr3d_acc_mean = mean(mr3d_acc), 
            sd = sd(mr3d_acc),
            se = std.error(mr3d_acc))

apt %>% 
  filter(!is.na(mr3d_rt)) %>% 
  group_by(session) %>% 
  summarise(mr3d_rt_mean = mean(mr3d_rt), 
            sd = sd(mr3d_rt),
            se = std.error(mr3d_rt))

apt %>% 
  filter(!is.na(mr3d_sats)) %>% 
  group_by(session) %>% 
  summarise(mr3d_sats_mean = mean(mr3d_sats), 
            sd = sd(mr3d_sats),
            se = std.error(mr3d_sats))
```

### Barratt Impulsivity Scale
```{r bis_summary}
apt %>% 
  filter(!is.na(bis_tot)) %>% 
  group_by(session) %>% 
  summarise(bis_tot_mean = mean(bis_tot), 
            sd = sd(bis_tot),
            se = std.error(bis_tot))

apt %>% 
  filter(!is.na(bis_att)) %>% 
  group_by(session) %>% 
  summarise(bis_att_mean = mean(bis_att), 
            sd = sd(bis_att),
            se = std.error(bis_att))

apt %>% 
  filter(!is.na(bis_mot)) %>% 
  group_by(session) %>% 
  summarise(bis_mot_mean = mean(bis_mot), 
            sd = sd(bis_mot),
            se = std.error(bis_mot))

apt %>% 
  filter(!is.na(bis_nplan)) %>% 
  group_by(session) %>% 
  summarise(bis_nplan_mean = mean(bis_nplan), 
            sd = sd(bis_nplan),
            se = std.error(bis_nplan))
```

### Others
Data for the MLAT Number Learning task and the Summarising Task were only collected at session 1 for two of three cohorts only, so there is no change over time to plot. The Barratt Impulsivity Scale was only collected at sessions three and four and no change over time was predicted.

# Plots

Let's plot the linguistic & cognitive assessments over time 

```{r plot-theme}
# set up a theme for the plots
theme_details <- theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          plot.title = element_text(face = "bold"),
          axis.title.x = element_text(face = "bold"),
          axis.title.y = element_text(face = "bold"),
          axis.text.x = element_text(size=10, colour="black"),
          axis.text.y = element_text(colour="black"),
          legend.position = "none")
```

### Dual N-Back
#### Letter matching
```{r nback_lett}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(nback_lett)) %>% 
  ggplot(aes(x = session, y = nback_lett, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
 #geom_boxplot(position = position_nudge(x = .2, y = 0),
 #                width = .2, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +  
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy in letter matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy") +
  theme_details )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(nback_lett)) %>% 
  summarize(mean=mean(nback_lett), sd = sd(nback_lett), se=std.error(nback_lett)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  coord_cartesian(ylim = c(0.5, 0.8)) +
  theme_minimal() +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Accuracy in letter matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1)) 

indiv <- apt %>% 
  filter(!is.na(nback_lett)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(nback_lett)) #, sd = sd(nback_lett)) # requires trial level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )
```

#### Spatial matching
```{r nback_spat}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(nback_spat)) %>% 
  ggplot(aes(x = session, y = nback_spat, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +  
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy in spatial matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy") +
  theme_details )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(nback_spat)) %>% 
  summarize(mean=mean(nback_spat), sd = sd(nback_spat), se=std.error(nback_spat)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  coord_cartesian(ylim = c(0.5, 0.8)) +
  theme_minimal() +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Accuracy in spatial matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1)) 

indiv <- apt %>% 
  filter(!is.na(nback_spat)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(nback_spat)) #, sd = sd(nback_spat)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )
```

#### Combined accuracy
```{r nback_comb}
## Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(nback_comb)) %>% 
  ggplot(aes(x = session, y = nback_comb, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .1, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitternudge(jitter.width = .4, nudge.x = -.15), 
                        size = 2, shape = 21) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +  
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Combined accuracy on Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy") +
  theme_details )

# Jitter plot  
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(nback_comb)) %>% 
  summarize(mean=mean(nback_comb), sd = sd(nback_comb), se=std.error(nback_comb)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  coord_cartesian(ylim = c(0.5, 0.8)) +
  theme_minimal() +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Combined accuracy on Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1))

indiv <- apt %>% 
  filter(!is.na(nback_comb)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(nback_comb)) #, sd = sd(nback_comb)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details ) 
```

### Corsi Blocks

How does Accuracy on the Corsi Blocks task change over time?
```{r corsi_corr}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(corsi_corr)) %>% 
  ggplot(aes(x = session, y = corsi_corr, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .1, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitternudge(jitter.width = .4, nudge.x = -.15), 
                        size = 2, shape = 21) +
  coord_cartesian(ylim = c(5, 15)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +  
  scale_y_continuous(labels = scales::number_format(accuracy = 1)) +
  labs(title = "Correct Responses on Corsi Blocks Task by Session", 
       x = "Session", y = "Correct Response") +
  theme_details )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(corsi_corr)) %>% 
  summarize(mean=mean(corsi_corr), sd = sd(corsi_corr), se=std.error(corsi_corr)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 15)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Correct Responses on Corsi Blocks Task by Session", 
       x = "Session", y = "Correct Response")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(corsi_corr)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(corsi_corr)) #, sd = sd(corsi_corr)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details ) 
```


### Kirklees Sentence Reading
How does Accuracy on the Kirklees Sentence Reading task change over time?
```{r kirk_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kirk_acc)) %>% 
  ggplot(aes(x = session, y = kirk_acc, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  coord_cartesian(ylim = c(0.45, 1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +  
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Accuracy") +
  theme_details )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kirk_acc)) %>% 
  summarize(mean=mean(kirk_acc), sd = sd(kirk_acc), se=std.error(kirk_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kirk_acc)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kirk_acc)) #, sd = sd(kirk_acc) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details ) 
```

### KBIT-2 Matrices
How does Accuracy on the KBIT-2 Matrices task change over time? 

```{r kbit_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kbit_acc)) %>% 
  ggplot(aes(x = session, y = kbit_acc, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  coord_cartesian(ylim = c(.65, 1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +  
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Accuracy") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kbit_acc)) %>% 
  summarize(mean=mean(kbit_acc), 
            sd = sd(kbit_acc), se=std.error(kbit_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(.5, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kbit_acc)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kbit_acc)) #, sd = sd(kbit_acc) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )  
```

### Digit Span
#### Accuracy
```{r dspan_corr}
# Raincloud plot
( R1 <- apt %>% 
  #filter(!is.na(dspan_corr)) %>% 
  ggplot(aes(x = session, y = dspan_corr, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .1, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitternudge(jitter.width = .4, nudge.x = -.15), 
                        size = 2, shape = 21) +
  coord_cartesian(ylim = c(0.5, 0.9)) +
  scale_fill_manual(values = c("#7bccc4", "#43a2ca", "#0868ac", "#bae4bc")) +  
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on Digit Span Task by Session", 
       x = "Session", y = "Accuracy") +
  theme_details )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  #filter(!is.na(dspan_corr)) %>% 
  summarize(mean=mean(dspan_corr), 
            sd = sd(dspan_corr), se=std.error(dspan_corr)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0.5, 0.9)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on Digit Span Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  #filter(!is.na(dspan_corr)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(dspan_corr)) #, sd = sd(dspan_corr)) # requires trial-level data

indiv2 <- apt %>% 
  filter(!is.na(dspan_corr)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(dspan_corr)) #, sd = sd(dspan_corr)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv2, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )
```

#### Memory Span
```{r dspan_mem}
# Raincloud plot
( R1 <- apt %>% 
  #filter(!is.na(dspan_mem)) %>% 
  ggplot(aes(x = session, y = dspan_mem, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  coord_cartesian(ylim = c(4, 11)) +
  scale_fill_manual(values = c("#7bccc4", "#43a2ca", "#0868ac", "#bae4bc")) +   
  labs(title = "Memory Span on Digit Span Task by Session", 
       x = "Session", y = "Memory Span") +
  theme_details )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(dspan_mem)) %>% 
  summarize(mean=mean(dspan_mem), 
            sd = sd(dspan_mem), se=std.error(dspan_mem)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 8)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(4, 11)) +
  labs(title = "Memory Span on Digit Span Task by Session", 
       x = "Session", y = "Memory Span")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(dspan_mem)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(dspan_mem)) #, sd = sd(dspan_mem)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )
```


### 2D Mental Rotation
#### Accuracy
```{r mr2d_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr2d_acc)) %>% 
  ggplot(aes(x = session, y = mr2d_acc, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .1, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitternudge(jitter.width = .4, nudge.x = -.15), 
                        size = 2, shape = 21) +
  coord_cartesian(ylim = c(0.5, 1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 2D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy") +
  theme_details )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr2d_acc)) %>% 
  summarize(mean=mean(mr2d_acc), sd = sd(mr2d_acc), se=std.error(mr2d_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0.5, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 2D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr2d_acc)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr2d_acc)) #, sd = sd(mr2d_acc)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details ) 

# Raincloud + Jitter
( RJ <- apt %>% 
  filter(!is.na(mr2d_acc)) %>% 
  ggplot(aes(x = session, y = mr2d_acc, group = session, fill = session)) +
  geom_point(data=indiv, aes(x = session, y = mean, group = ppt),
             position = position_jitternudge(jitter.width = .4, nudge.x = -.15), 
                        size = 2, shape = 21) +
  geom_line(data = indiv, aes(x = session, y = mean, group = ppt),
                      size = 0.1, alpha = 0.3, 
            position = position_jitternudge(jitter.width = .4, nudge.x = -.15)) +
  geom_flat_violin(position = position_nudge(x = .1, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  coord_cartesian(ylim = c(0.5, 1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 2D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy") +
  theme_details )

```

#### Reaction Time
```{r mr2d_rt}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr2d_rt)) %>% 
  ggplot(aes(x = session, y = mr2d_rt, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0, 8500)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Reaction Time on 2D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr2d_rt)) %>% 
  summarize(mean=mean(mr2d_rt), sd = sd(mr2d_rt), se=std.error(mr2d_rt)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 8500)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Reaction Time on 2D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr2d_rt)) %>% 
  filter(ppt != "HW025") %>% ## removing extreme outlier
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr2d_rt)) #, sd = sd(mr2d_rt)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )


# Raincloud + Jitter plot
( RJ <- apt %>% 
  filter(!is.na(mr2d_rt)) %>% 
  filter(ppt != "HW025") %>% ## removing extreme outlier
  ggplot(aes(x = session, y = mr2d_rt, group = session, fill = session)) +
  geom_line(data = indiv, aes(x = session, y = mean, group = ppt),
                      size = 0.1, alpha = 0.3, position = pd) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(data=indiv, aes(x = session, y = mean, group = ppt), size = 2, 
                       shape = 21, position = pd) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(0, 4500)) +
  labs(title = "Reaction Time on 2D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)") +
  theme_details )
```


#### Speed-Accuracy Trade-off Score
```{r mr2d-sats}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr2d_sats)) %>% 
  ggplot(aes(x = session, y = mr2d_sats, group = session, fill = session)) +
  geom_hline(yintercept = 0, alpha = .3) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(-3, 3)) +
  labs(title = "Speed-Accuracy Trade-off Score on 2D Mental Rotation Task by Session", 
       x = "Session", 
       y = "Speed-Accuracy Trade-off Score\n(Balanced Integration Score") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr2d_sats)) %>% 
  summarize(mean=mean(mr2d_sats), sd = sd(mr2d_sats), se=std.error(mr2d_sats)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(-3, 3)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Speed-Accuracy Trade-off Score on 2D Mental Rotation Task by Session", 
       x = "Session", 
       y = "Speed-Accuracy Trade-off Score\n(Balanced Integration Score)")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr2d_sats)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr2d_sats)) #, sd = sd(mr2d_rt)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )

( RJ <- apt %>% 
  filter(!is.na(mr2d_sats)) %>% 
  ggplot(aes(x = session, y = mr2d_sats, group = session, fill = session)) +
  geom_hline(yintercept = 0, alpha = 0.4, linetype = "dashed") +
  geom_line(data = indiv, aes(x = session, y = mean, group = ppt),
                      size = 0.1, alpha = 0.5, position = pd) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(data=indiv, aes(x = session, y = mean, group = ppt, fill = session),
             size = 2, shape = 21, position = pd) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(-3, 2)) +
  labs(title = "Speed-Accuracy Trade-off Score on 2D Mental Rotation Task by Session", 
       x = "Session", 
       y = "Speed-Accuracy Trade-off Score\n(Balanced Integration Score)") +
  theme_details )
```

### 3D Mental Rotation
#### Accuracy
```{r mr3d_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr3d_acc)) %>% 
  #filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  ggplot(aes(x = session, y = mr3d_acc, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0, 1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 3D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr3d_acc)) %>% 
  #filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  summarize(mean=mean(mr3d_acc), sd = sd(mr3d_acc), se=std.error(mr3d_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 3D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr3d_acc)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr3d_acc)) #, sd = sd(mr3d_acc)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details ) 
```

#### Reaction Time
```{r mr3d_rt}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr3d_rt)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  ggplot(aes(x = session, y = mr3d_rt, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0, 4500)) +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  labs(title = "Reaction Time on 3D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr3d_rt)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  summarize(mean=mean(mr3d_rt), sd = sd(mr3d_rt), se=std.error(mr3d_rt)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 4500)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  labs(title = "Reaction Time on 3D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr3d_rt)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr3d_rt)) #, sd = sd(mr3d_rt)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )

# Raincloud + Jitter
( RJ <- apt %>% 
  filter(!is.na(mr3d_rt)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  ggplot(aes(x = session, y = mr3d_rt, group = session, fill = session)) +
  geom_line(data = indiv, aes(x = session, y = mean, group = ppt),
                      size = 0.1, alpha = 0.3, position = pd) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(data=indiv, aes(x = session, y = mean, group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(0, 4500)) +
  labs(title = "Reaction Time on 3D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)") )
```

#### Speed-Accuracy Trade-off Score
```{r mr3d-sats}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr3d_sats)) %>% 
  ggplot(aes(x = session, y = mr3d_sats, group = session, fill = session)) +
  geom_hline(yintercept = 0, alpha = .3) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(-4, 3)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Speed-Accuracy Trade-off Score on 3D Mental Rotation Task by Session", 
       x = "Session", 
       y = "Speed-Accuracy Trade-off Score\n(Balanced Integration Score)") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr3d_sats)) %>% 
  #filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  summarize(mean=mean(mr3d_sats), sd = sd(mr3d_sats), se=std.error(mr3d_sats)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(-4, 3)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Speed-Accuracy Trade-off Score on 3D Mental Rotation Task by Session", 
       x = "Session", 
       y = "Speed-Accuracy Trade-off Score\n(Balanced Integration Score)") 

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr3d_sats)) %>% 
  #filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr3d_sats)) #, sd = sd(mr3d_sats)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details )

# Raincloud + Jitter

( RJ <- apt %>% 
  filter(!is.na(mr3d_sats)) %>% 
  ggplot(aes(x = session, y = mr3d_sats, group = session, fill = session)) +
  geom_hline(yintercept = 0, alpha = 0.4, linetype = "dashed") +
  geom_line(data = indiv, aes(x = session, y = mean, group = ppt),
                      size = 0.1, alpha = 0.5, position = pd) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(data=indiv, aes(x = session, y = mean, group = ppt, fill = session),
             size = 2, shape = 21, position = pd) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(-4, 3)) +
  labs(title = "Speed-Accuracy Trade-off Score on 3D Mental Rotation Task by Session", 
       x = "Session", 
       y = "Speed-Accuracy Trade-off Score\n(Balanced Integration Score)") +
  theme_details )
```

### Barratt Impulsivity Scale
#### Total Score
```{r bis_tot}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(bis_tot)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  ggplot(aes(x = session, y = bis_tot, group = session, fill = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 1) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  scale_fill_manual(values = c("#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(0, 100)) +
  labs(title = "Total Score on Barratt Impulsivity Scale by Session", 
       x = "Session", y = "Total Score") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(bis_tot)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  summarize(mean=mean(bis_tot), sd = sd(bis_tot), se=std.error(bis_tot)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 100)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#43a2ca", "#0868ac")) +
  labs(title = "Total Score on Barratt Impulsivity Scale by Session", 
       x = "Session", y = "Total Score")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(bis_tot)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  group_by(session, ppt) %>% 
  summarise(mean = mean(bis_tot)) #, sd = sd(mr3d_acc)) # requires trial-level data

J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

( J4 <- J3 + theme_details ) 
```

# Models
Does performance on these cognitive and linguistic assessments change over time?

## Dual N-Back
```{r nback-mdl}
# Does session predict Dual N-Back results?
( nback_comb_mdl <- lm(nback_comb ~ session, 
                  data = apt) ) 

summary(nback_comb_mdl)

( nback_lett_mdl <- lm(nback_lett ~ session, 
                  data = apt) ) 

summary(nback_lett_mdl)

( nback_spat_mdl <- lm(nback_spat ~ session, 
                  data = apt) ) 

summary(nback_spat_mdl)
```

## Corsi Blocks
```{r corsi-mdl}
# Does session predict Corsi Blocks results?
( corsi_corr_mdl <- lm(corsi_corr ~ session, 
                  data = apt) ) 

summary(corsi_corr_mdl)
```

## Kirklees Sentence Reading
```{r kirk-mdl}
# Does session predict Kirklees Sentence Reading results?
( kirk_mdl <- lm(kirk_acc ~ session, 
                 data = apt) ) 

summary(kirk_mdl)
```

## KBIT-2 Matrices
```{r kbit-mdl}
# Does session predict KBIT-2 Matrices results?
( kbit_mdl <- lm(kbit_acc ~ session, 
                  data = apt) ) 

summary(kbit_mdl)
```

## Digit Span
```{r dspan-mdl}
# Does session predict Digit Span results?
( dspan_corr_mdl <- lm(dspan_corr ~ session, 
                  data = apt) ) 

summary(dspan_corr_mdl)

( dspan_mem_mdl <- lm(dspan_mem ~ session, 
                  data = apt) ) 

summary(dspan_mem_mdl)
```

## 2D Mental Rotation
```{r mr2d-mdl}
# Does session predict 2D Mental Rotation results?
( mr2d_sats_mdl <- lm(mr2d_sats ~ session, 
                  data = apt) ) 

summary(mr2d_sats_mdl)

( mr2d_rt_mdl <- lm(mr2d_rt ~ session, 
                  data = apt) ) 

summary(mr2d_rt_mdl)

apt2 <- apt %>% 
  filter(ppt != "HW025") 

( mr2d_rt_mdl2 <- lm(mr2d_rt ~ session, 
                  data = apt2) ) 

summary(mr2d_rt_mdl2)
```

## 3D Mental Rotation
```{r mr3d-mdl}
# Does session predict 3D Mental Rotation results?
( mr3d_sats_mdl <- lm(mr3d_sats ~ session, 
                  data = apt) ) 

summary(mr3d_sats_mdl)

( mr3d_acc_mdl <- lm(mr3d_acc ~ session, 
                  data = apt) ) 

summary(mr3d_acc_mdl)

( mr3d_rt_mdl <- lm(mr3d_rt ~ session, 
                  data = apt) ) 

summary(mr3d_rt_mdl)
```

## Barratt Impulsivity Scale
```{r bis-mdl}
# relevel session because data only for 2nd year vs 3rd year
apt$session <- fct_relevel(apt$session, "2nd year", after = 0)

# Does session predict Barratt Impulsivity Scale results?
( bis_mdl <- lm(bis_tot ~ session, 
                  data = apt) ) 

summary(bis_mdl)
# relevel back again 
apt$session <- fct_relevel(apt$session, "2nd year", after = 2)
```