---
title: "Sign Language Interpreter Cognitive Aptitude analysis"
author:
  - name: "Freya Watkins"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 5
    number_sections: false
    theme: flatly
    highlight: haddock
---

# Setup
```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
```

## Load packages
```{r load_packages, message = FALSE, warning = FALSE}
library(here) # file organisation & folder location
library(tidyverse) # data wrangling & plotting
library(naniar) # dealing with missing values
library(PupillometryR) # raincloud plots
library(plotrix) # for calculating standard error
library(scales) # scales on plots
library(psych) # for factor analysis
```

### R / package versions used
```{r r_package_versions, message = FALSE, warning = FALSE}
R.Version() 
packageVersion('here')
packageVersion('tidyverse')
packageVersion('psych')
```

## Read in data
```{r read_in_data}
here::here()
apt <- read_csv(here("data", "2022-03-11_SLI_aptitude_data.csv"))
apt <- as_tibble(apt)
```

### Look at data
```{r look_at_data}
head(apt)
tail(apt)
names(apt)
summary(apt)
```

#### Summarise missingness
```{r}
apt %>% select(-session:-ppt, -comments) %>% 
  naniar::miss_var_summary() # data is in long format though

apt_wide <- apt %>% 
  tidyr::pivot_wider(names_from = session, 
                     values_from = c(nback_lett:comments))

naniar::miss_var_summary(apt_wide)

vis_miss(apt) # visualise missingness
vis_miss(apt_wide) # visualise missingness
vis_miss(apt, cluster = TRUE) # arrange rows according to missingness

# Show missingness on a row by row basis i.e. by participant & session
gg_miss_case(apt)
```
Not all of the missingness is a problem, for some variables we did not plan to test on all participants

#### Test imputation
```{r}
# simple imputation of replacing all NAs with the mean of that column
imp_mean <- apt_wide %>% 
  bind_shadow(only_miss = TRUE) %>% 
  add_label_shadow() %>% 
  impute_mean_all()
# this keeps the mean of each variable the same (good) but decreases the variance (bad), increasing bias. this method also doesn't take into account other factors that could better predict more plausible values than just using the mean

library(simputation) 
# imp_lm <- imp_mean %>% impute_lm(Y ~ X1 + X2)
# not sure how to use this yet

# or use {mice}
library(mice)
md.pattern(apt_wide)

# impute variables using predictive mean matching (PMM)
#test_mice <- mice(apt_wide, m=5, maxit=50, meth='pmm', seed=500)
#imputed_mice <- mice(apt_wide, m=5, method = "pmm") 

# summary(imputed_mice) # check summary
#imputed_mice$imp  # check imputed values

# get back to completed data set
#completed_apt <- complete(imputed_mice)
#head(completed_apt)
# certain columns are not fully imputed because they are perfectly collinear with other columns. we can see which columms are collinear:
apt_wide_m <- select(apt_wide, nback_lett_1:mr3d_rt_3, 
                               mlat_raw_1:mlat_acc_3, 
                               grade_bsl_1:grade_terp_3)
apt_wide_m <- as.matrix(apt_wide_m)
#cor(apt_wide_m, use = "pairwise.complete.obs")
#mice:::find.collinear(completed_apt)
#mice(pred = diag(ncol()))

#init = mice(apt_wide, maxit=0) 
#meth = init$method
#predM = init$predictorMatrix

# remove specific variable as a predictor for imputation
#predM[c("group")]=0

# or use k-nearest neighbor  imputation in {bnstruct}
```

### Convert variables   

Session and Group should be factors:  
```{r convert_variables}
apt$session <- as.factor(apt$session)
apt$group <- as.factor(apt$group)
apt$ppt <- as.factor(apt$ppt)

apt$bis_tot <- as.numeric(apt$bis_tot)
apt$bis_att <- as.numeric(apt$bis_att)
apt$bis_mot <- as.numeric(apt$bis_mot)
apt$bis_nplan <- as.numeric(apt$bis_nplan)
apt$dspan_time <- as.numeric(apt$dspan_time)
```

Rename levels of Session:  
```{r relevel_session}
apt$session <- plyr::revalue(apt$session, c("1" = "pre-degree", 
                                            "2" = "1st year", 
                                            "3" = "2nd year",
                                            "4" = "3rd year"))
```

# Summary tables

## Cognitive & Linguistic predictors

### Dual N-Back
```{r nback_summary}
apt %>% 
  filter(!is.na(nback_lett)) %>% 
  group_by(session) %>% 
  summarise(nback_lett_mean = mean(nback_lett), 
            sd = sd(nback_lett),
            se = std.error(nback_lett))

apt %>% 
  filter(!is.na(nback_spat)) %>% 
  group_by(session) %>% 
  summarise(nback_spat_mean = mean(nback_spat), 
            sd = sd(nback_spat),
            se = std.error(nback_spat))

apt %>% 
  filter(!is.na(nback_comb)) %>% 
  group_by(session) %>% 
  summarise(nback_comb_mean = mean(nback_comb), 
            sd = sd(nback_comb),
            se = std.error(nback_comb))
```

### Corsi Blocks
```{r corsi_summary}
apt %>% 
  filter(!is.na(corsi_bspan)) %>% 
  group_by(session) %>% 
  summarise(corsi_bspan_mean = mean(corsi_bspan), 
            sd = sd(corsi_bspan),
            se = std.error(corsi_bspan))

apt %>% 
  filter(!is.na(corsi_score)) %>% 
  group_by(session) %>% 
  summarise(corsi_score_mean = mean(corsi_score), 
            sd = sd(corsi_score),
            se = std.error(corsi_score))

apt %>% 
  filter(!is.na(corsi_corr)) %>% 
  group_by(session) %>% 
  summarise(corsi_corr_mean = mean(corsi_corr), 
            sd = sd(corsi_corr),
            se = std.error(corsi_corr))

apt %>% 
  filter(!is.na(corsi_mspan)) %>% 
  group_by(session) %>% 
  summarise(corsi_mspan_mean = mean(corsi_mspan), 
            sd = sd(corsi_mspan),
            se = std.error(corsi_mspan))
```

### Kirklees Sentence Reading
```{r kirklees_summary}
apt %>% 
  filter(!is.na(kirk_ceil)) %>% 
  group_by(session) %>% 
  summarise(kirk_ceil_mean = mean(kirk_ceil), 
            sd = sd(kirk_ceil),
            se = std.error(kirk_ceil))

apt %>% 
  filter(!is.na(kirk_raw)) %>% 
  group_by(session) %>% 
  summarise(kirk_raw_mean = mean(kirk_raw), 
            sd = sd(kirk_raw),
            se = std.error(kirk_raw))

apt %>% 
  filter(!is.na(kirk_acc)) %>% 
  group_by(session) %>% 
  summarise(kirk_acc_mean = mean(kirk_acc), 
            sd = sd(kirk_acc),
            se = std.error(kirk_acc))
```

### KBIT-2 Matrices
```{r kbit_summary}
apt %>% 
  filter(!is.na(kbit_ceil)) %>% 
  group_by(session) %>% 
  summarise(kirk_ceil_mean = mean(kbit_ceil), 
            sd = sd(kbit_ceil),
            se = std.error(kbit_ceil))

apt %>% 
  filter(!is.na(kbit_raw)) %>% 
  group_by(session) %>% 
  summarise(kbit_raw_mean = mean(kbit_raw), 
            sd = sd(kbit_raw),
            se = std.error(kbit_raw))

apt %>% 
  filter(!is.na(kbit_acc)) %>% 
  group_by(session) %>% 
  summarise(kbit_acc_mean = mean(kbit_acc), 
            sd = sd(kbit_acc),
            se = std.error(kbit_acc))
```

### Digit Span
```{r dspan_summary}
apt %>% 
  filter(!is.na(dspan_mem)) %>% 
  group_by(session) %>% 
  summarise(dspan_mem_mean = mean(dspan_mem), 
            sd = sd(dspan_mem),
            se = std.error(dspan_mem))

apt %>% 
  filter(!is.na(dspan_corr)) %>% 
  group_by(session) %>% 
  summarise(dspan_corr_mean = mean(dspan_corr), 
            sd = sd(dspan_corr),
            se = std.error(dspan_corr))

apt %>% 
  filter(!is.na(dspan_time)) %>% 
  group_by(session) %>% 
  summarise(dspan_time_mean = mean(dspan_time), 
            sd = sd(dspan_time),
            se = std.error(dspan_time))
```

### 2D Mental Rotation
```{r 2dmr_summary}
apt %>% 
  filter(!is.na(mr2d_acc)) %>% 
  group_by(session) %>% 
  summarise(mr2d_acc_mean = mean(mr2d_acc), 
            sd = sd(mr2d_acc),
            se = std.error(mr2d_acc))

apt %>% 
  filter(!is.na(mr2d_rt)) %>% 
  group_by(session) %>% 
  summarise(mr2d_rt_mean = mean(mr2d_rt), 
            sd = sd(mr2d_rt),
            se = std.error(mr2d_rt))
```

### 3D Mental Rotation
```{r 3dmr_summary}
apt %>% 
  filter(!is.na(mr3d_acc)) %>% 
  group_by(session) %>% 
  summarise(mr3d_acc_mean = mean(mr3d_acc), 
            sd = sd(mr3d_acc),
            se = std.error(mr3d_acc))

apt %>% 
  filter(!is.na(mr3d_rt)) %>% 
  group_by(session) %>% 
  summarise(mr3d_rt_mean = mean(mr3d_rt), 
            sd = sd(mr3d_rt),
            se = std.error(mr3d_rt))
```

### Barratt Impulsivity Scale
```{r bis_summary}
apt %>% 
  filter(!is.na(bis_tot)) %>% 
  group_by(session) %>% 
  summarise(bis_tot_mean = mean(bis_tot), 
            sd = sd(bis_tot),
            se = std.error(bis_tot))

apt %>% 
  filter(!is.na(bis_att)) %>% 
  group_by(session) %>% 
  summarise(bis_att_mean = mean(bis_att), 
            sd = sd(bis_att),
            se = std.error(bis_att))

apt %>% 
  filter(!is.na(bis_mot)) %>% 
  group_by(session) %>% 
  summarise(bis_mot_mean = mean(bis_mot), 
            sd = sd(bis_mot),
            se = std.error(bis_mot))

apt %>% 
  filter(!is.na(bis_nplan)) %>% 
  group_by(session) %>% 
  summarise(bis_nplan_mean = mean(bis_nplan), 
            sd = sd(bis_nplan),
            se = std.error(bis_nplan))
```

### MLAT Number Learning
Only collected at session 1 for grant cohort only

### Summarising Task
Only collected at session 1 for grant cohort only

## BSL / Interpreting outcome variables

### Copy Sign Task
```{r copy_sign}
# data to be coded
```

### BSL Sentence Reproduction Task
```{r bslsrt}
# data to be coded
```

### BSL Town Map
```{r town_map}
# data to be coded
```

### BSL Grades
```{r grades_bsl}
apt %>% 
  filter(!is.na(grade_bsl)) %>% 
  group_by(session) %>% 
  summarise(grade_bsl_mean = mean(grade_bsl), 
            sd = sd(grade_bsl),
            se = std.error(grade_bsl))
```

### Interpreting Grades
```{r grades_terp}
apt %>% 
  filter(!is.na(grade_terp)) %>% 
  group_by(session) %>% 
  summarise(grade_terp_mean = mean(grade_terp), 
            sd = sd(grade_terp),
            se = std.error(grade_terp))
```
# Plots

## Linguistic & cognitive predictors over time 

### Dual N-Back
#### Accuracy in letter matching
```{r nback_lett}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(nback_lett)) %>% 
  ggplot(aes(x = session, y = nback_lett, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy in letter matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(nback_lett)) %>% 
  summarize(mean=mean(nback_lett), sd = sd(nback_lett), se=std.error(nback_lett)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  coord_cartesian(ylim = c(0.5, 0.8)) +
  theme_minimal() +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Accuracy in letter matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1)) 

indiv <- apt %>% 
  filter(!is.na(nback_lett)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(nback_lett)) #, sd = sd(nback_lett)) # requires trial level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  

```

#### Accuracy in spatial matching
```{r nback_spat}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(nback_spat)) %>% 
  ggplot(aes(x = session, y = nback_spat, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy in spatial matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(nback_spat)) %>% 
  summarize(mean=mean(nback_spat), sd = sd(nback_spat), se=std.error(nback_spat)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  coord_cartesian(ylim = c(0.5, 0.8)) +
  theme_minimal() +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Accuracy in spatial matching during Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1)) 

indiv <- apt %>% 
  filter(!is.na(nback_spat)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(nback_spat)) #, sd = sd(nback_spat)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Combined accuracy
```{r nback_comb}
## Raincloud plot
apt %>% 
  filter(!is.na(nback_comb)) %>% 
  ggplot(aes(x = session, y = nback_comb, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Combined accuracy on Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy")

# Jitter plot  
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(nback_comb)) %>% 
  summarize(mean=mean(nback_comb), sd = sd(nback_comb), se=std.error(nback_comb)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  coord_cartesian(ylim = c(0.5, 0.8)) +
  theme_minimal() +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Combined accuracy on Dual N-Back Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5) +
  scale_y_continuous(labels = percent_format(accuracy=1))

indiv <- apt %>% 
  filter(!is.na(nback_comb)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(nback_comb)) #, sd = sd(nback_comb)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

### Corsi Blocks
#### Block Span
```{r corsi_bspan}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(corsi_bspan)) %>% 
  ggplot(aes(x = session, y = corsi_bspan, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  labs(title = "Block span on Corsi Blocks Task by Session", 
       x = "Session", y = "Block Span") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(corsi_bspan)) %>% 
  summarize(mean=mean(corsi_bspan), sd = sd(corsi_bspan), se=std.error(corsi_bspan)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 10)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Block span on Corsi Blocks Task by Session", 
       x = "Session", y = "Block Span")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(corsi_bspan)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(corsi_bspan)) #, sd = sd(corsi_bspan)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Raw Score
```{r corsi_score}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(corsi_score)) %>% 
  ggplot(aes(x = session, y = corsi_score, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  labs(title = "Raw Score on Corsi Blocks Task by Session", 
       x = "Session", y = "Score") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(corsi_score)) %>% 
  summarize(mean=mean(corsi_score), sd = sd(corsi_score), se=std.error(corsi_score)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 125)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Raw Score on Corsi Blocks Task by Session", 
       x = "Session", y = "Score")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(corsi_score)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(corsi_score)) #, sd = sd(corsi_score)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Correct Responses
```{r corsi_corr}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(corsi_corr)) %>% 
  ggplot(aes(x = session, y = corsi_corr, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(5, 15)) +
  scale_y_continuous(labels = scales::number_format(accuracy = 1)) +
  labs(title = "Correct Responses on Corsi Blocks Task by Session", 
       x = "Session", y = "Correct Response") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(corsi_corr)) %>% 
  summarize(mean=mean(corsi_corr), sd = sd(corsi_corr), se=std.error(corsi_corr)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 15)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Correct Responses on Corsi Blocks Task by Session", 
       x = "Session", y = "Correct Response")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(corsi_corr)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(corsi_corr)) #, sd = sd(corsi_corr)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Memory Span
```{r corsi_mspan}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(corsi_mspan)) %>% 
  ggplot(aes(x = session, y = corsi_mspan, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  labs(title = "Memory Span on Corsi Blocks Task by Session", 
       x = "Session", y = "Memory Span") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(corsi_mspan)) %>% 
  summarize(mean=mean(corsi_mspan), sd = sd(corsi_mspan), se=std.error(corsi_mspan)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 8)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Memory Span on Corsi Blocks Task by Session", 
       x = "Session", y = "Memory Span")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(corsi_mspan)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(corsi_mspan)) #, sd = sd(corsi_mspan)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

### Kirklees Sentence Reading
#### Ceiling Score
```{r kirk_ceil}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kirk_ceil)) %>% 
  ggplot(aes(x = session, y = kirk_ceil, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  labs(title = "Ceiling Score on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Ceiling Score") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kirk_ceil)) %>% 
  summarize(mean=mean(kirk_ceil), sd = sd(kirk_ceil), se=std.error(kirk_ceil)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 45)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Ceiling Score on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Ceiling Score")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kirk_ceil)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kirk_ceil)) #, sd = sd(kirk_ceil) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Raw Score
```{r kirk_raw}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kirk_raw)) %>% 
  ggplot(aes(x = session, y = kirk_raw, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  labs(title = "Raw Score on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Ceiling Score") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kirk_raw)) %>% 
  summarize(mean=mean(kirk_raw), sd = sd(kirk_raw), se=std.error(kirk_raw)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 45)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Raw Score on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Raw Score")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kirk_raw)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kirk_raw)) #, sd = sd(kirk_raw) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Accuracy
```{r kirk_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kirk_acc)) %>% 
  ggplot(aes(x = session, y = kirk_acc, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  coord_cartesian(ylim = c(0.45, 1)) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Accuracy") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kirk_acc)) %>% 
  summarize(mean=mean(kirk_acc), sd = sd(kirk_acc), se=std.error(kirk_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on Kirklees Sentence Reading Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kirk_acc)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kirk_acc)) #, sd = sd(kirk_acc) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

### KBIT-2 Matrices

#### Ceiling Score
```{r kbit_ceil}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kbit_ceil)) %>% 
  ggplot(aes(x = session, y = kbit_ceil, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  labs(title = "Ceiling Score on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Ceiling Score") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kbit_ceil)) %>% 
  summarize(mean=mean(kbit_ceil), sd = sd(kbit_ceil), se=std.error(kbit_ceil)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 48)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Ceiling Score on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Ceiling Score")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kirk_ceil)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kbit_ceil)) #, sd = sd(kbit_ceil) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Raw Score
```{r kbit_raw}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kbit_raw)) %>% 
  ggplot(aes(x = session, y = kbit_raw, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  labs(title = "Raw Score on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Ceiling Score") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kbit_raw)) %>% 
  summarize(mean=mean(kbit_raw), sd = sd(kbit_raw), se=std.error(kbit_raw)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 45)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca")) +
  labs(title = "Raw Score on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Raw Score")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kbit_raw)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kbit_raw)) #, sd = sd(kbit_raw) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Accuracy
```{r kbit_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(kbit_acc)) %>% 
  ggplot(aes(x = session, y = kbit_acc, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  coord_cartesian(ylim = c(.65, 1)) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Accuracy") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(kbit_acc)) %>% 
  summarize(mean=mean(kbit_acc), 
            sd = sd(kbit_acc), se=std.error(kbit_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(.5, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Accuracy on KBIT-2 Matrices Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(kbit_acc)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(kbit_acc)) #, sd = sd(kbit_acc) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

### Digit Span
#### Accuracy
```{r dspan_corr}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(dspan_corr)) %>% 
  ggplot(aes(x = session, y = dspan_corr, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0.5, 0.9)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on Digit Span Task by Session", 
       x = "Session", y = "Accuracy") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(dspan_corr)) %>% 
  summarize(mean=mean(dspan_corr), sd = sd(dspan_corr), se=std.error(dspan_corr)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0.5, 0.9)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on Digit Span Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(dspan_corr)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(dspan_corr)) #, sd = sd(dspan_corr)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Memory Span
```{r dspan_mem}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(dspan_mem)) %>% 
  ggplot(aes(x = session, y = dspan_mem, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  coord_cartesian(ylim = c(4, 11)) +
  labs(title = "Memory Span on Digit Span Task by Session", 
       x = "Session", y = "Memory Span") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(dspan_mem)) %>% 
  summarize(mean=mean(dspan_mem), 
            sd = sd(dspan_mem), se=std.error(dspan_mem)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 8)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(4, 11)) +
  labs(title = "Memory Span on Digit Span Task by Session", 
       x = "Session", y = "Memory Span")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(dspan_mem)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(dspan_mem)) #, sd = sd(dspan_mem)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Time spent
```{r dspan_time}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(dspan_time)) %>% 
  ggplot(aes(x = session, y = dspan_time, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5) +
  coord_cartesian(ylim = c(0, 8)) +
  labs(title = "Time spent on Digit Span Task by Session", 
       x = "Session", y = "Memory Span") )
  
# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(dspan_time)) %>% 
  summarize(mean=mean(dspan_time), 
            sd = sd(dspan_time), se=std.error(dspan_time)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 8)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  coord_cartesian(ylim = c(0, 8)) +
  labs(title = "Time spent on Digit Span Task by Session", 
       x = "Session", y = "Memory Span")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(dspan_time)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(dspan_time)) #, sd = sd(dspan_time)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

### 2D Mental Rotation
#### Accuracy
```{r mr2d_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr2d_acc)) %>% 
  ggplot(aes(x = session, y = mr2d_acc, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0.5, 1)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 2D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr2d_acc)) %>% 
  summarize(mean=mean(mr2d_acc), sd = sd(mr2d_acc), se=std.error(mr2d_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0.5, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 2D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr2d_acc)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr2d_acc)) #, sd = sd(mr2d_acc)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Reaction Time
```{r mr2d_rt}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr2d_rt)) %>% 
  ggplot(aes(x = session, y = mr2d_rt, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0, 9000)) +
  labs(title = "Reaction Time on 2D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr2d_rt)) %>% 
  summarize(mean=mean(mr2d_rt), sd = sd(mr2d_rt), se=std.error(mr2d_rt)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 9000)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#7bccc4", "#43a2ca", "#0868ac")) +
  labs(title = "Reaction Time on 2D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr2d_rt)) %>% 
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr2d_rt)) #, sd = sd(mr2d_rt)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

### 3D Mental Rotation
#### Accuracy
```{r mr3d_acc}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr3d_acc)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  ggplot(aes(x = session, y = mr3d_acc, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0, 1)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 3D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr3d_acc)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  summarize(mean=mean(mr3d_acc), sd = sd(mr3d_acc), se=std.error(mr3d_acc)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 1)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Accuracy on 3D Mental Rotation Task by Session", 
       x = "Session", y = "Accuracy")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr3d_acc)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr3d_acc)) #, sd = sd(mr3d_acc)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

#### Reaction Time
```{r mr3d_rt}
# Raincloud plot
( R1 <- apt %>% 
  filter(!is.na(mr3d_rt)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  ggplot(aes(x = session, y = mr3d_rt, group = session)) +
  geom_flat_violin(position = position_nudge(x = .25, y = 0),
                   adjust = 2, trim = TRUE, alpha = 0.3) +
  geom_point(position = position_jitter(width = .15), 
                        size = 0.5)  +
  coord_cartesian(ylim = c(0, 5000)) +
  labs(title = "Reaction Time on 3D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)") )

# Jitter plot
J1 <- apt %>% 
  group_by(session) %>% 
  filter(!is.na(mr3d_rt)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  summarize(mean=mean(mr3d_rt), sd = sd(mr3d_rt), se=std.error(mr3d_rt)) %>%
  ggplot(aes(x = session, y = mean, fill = session)) +
  coord_cartesian(ylim = c(0, 5000)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  theme_minimal() +
  scale_fill_manual(values = c("#bae4bc", "#43a2ca", "#0868ac")) +
  labs(title = "Reaction Time on 3D Mental Rotation Task by Session", 
       x = "Session", y = "RT (ms)")

limits <- aes(ymax = mean + se, ymin = mean - se)
J2 <- J1 + geom_errorbar(position = position_dodge(), 
                          limits, size = 0.5, width = 0.5)

indiv <- apt %>% 
  filter(!is.na(mr3d_rt)) %>% 
  filter(session != "1st year") %>% #only 2 ppts at 2nd session>filter out
  group_by(session, ppt) %>% 
  summarise(mean = mean(mr3d_rt)) #, sd = sd(mr3d_rt)) # requires trial-level data

pd <- position_dodge(0.5)
J3 <- J2 + geom_point(data=indiv, aes(group = ppt), size = 0.8, 
                       shape = 19, position = pd) +
    geom_line(data = indiv, aes(group = ppt),
                      size = 0.1, position = pd)

(J4 <- J3 + theme_bw() + 
    theme(panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          panel.border = element_rect(colour = "black", size=0.5),
          axis.title.x = element_text(face = "bold"),
          legend.position = "none",
          axis.title.y = element_text(face = "bold"),
          axis.text.x=element_text(size=10, colour="black"),
          axis.text.y=element_text(colour="black")))  
```

### Barratt Impulsivity Scale
#### Total


## Effects of predictors on outcome variables

### Effects of predictors on BSL Grades

#### Dual N-Back vs BSL Grades
##### Accuracy in Letter Matching
```{r nback_lett_grade_bsl}
# Create wider pivot table
nback_lett_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, nback_lett, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(nback_lett, grade_bsl))

# Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree predict BSL grades at the end of 1st year?
nback_lett_grade_bsl_wide %>%
  ggplot(aes(x = `nback_lett_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy in Letter Matching on the Dual N-Back Task pre-degree")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study predict BSL grades at the end of 1st year?
nback_lett_grade_bsl_wide %>%
  ggplot(aes(x = `nback_lett_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study predict BSL grades at the end of 1st year?
nback_lett_grade_bsl_wide %>%
  ggplot(aes(x = `nback_lett_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 2 years")

# Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree predict BSL grades at the end of 2nd year?
nback_lett_grade_bsl_wide %>%
  ggplot(aes(x = `nback_lett_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy in Letter Matching on the Dual N-Back Task pre-degree")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study predict BSL grades at the end of 2nd year?
nback_lett_grade_bsl_wide %>%
  ggplot(aes(x = `nback_lett_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study predict BSL grades at the end of 2nd year?
nback_lett_grade_bsl_wide %>%
  ggplot(aes(x = `nback_lett_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 2 years")
```

```{r}
library(lme4)
library(afex)
( bsl_grade_mdl <- mixed(grade_bsl ~ nback_lett + mr3d_acc + corsi_corr + 
                       (1|ppt), apt, 
                     all_fit = TRUE, method = "LRT", #remove for lmer model
                 control = lmerControl(optCtrl = list(maxfun = 1e6))) )
summary(bsl_grade_mdl)


( bsl_grade_mdl_2 <- mixed(grade_bsl ~ kirk_acc + kbit_acc + dspan_corr + 
                       (1|ppt), apt, 
                     all_fit = TRUE, method = "LRT", #remove for lmer model
                 control = lmerControl(optCtrl = list(maxfun = 1e6))) )
summary(bsl_grade_mdl_2)
```


##### Accuracy in Spatial Matching
```{r nback_spat_grade_bsl}
# Create wider pivot table
nback_spat_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, nback_spat, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(nback_spat, grade_bsl))

# Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree predict BSL grades at the end of 1st year?
nback_spat_grade_bsl_wide %>%
  ggplot(aes(x = `nback_spat_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task pre-degre")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study predict BSL grades at the end of 1st year?
nback_spat_grade_bsl_wide %>%
  ggplot(aes(x = `nback_spat_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study predict BSL grades at the end of 1st year?
nback_spat_grade_bsl_wide %>%
  ggplot(aes(x = `nback_spat_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 2 years")

# Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree predict BSL grades at the end of 2nd year?
nback_spat_grade_bsl_wide %>%
  ggplot(aes(x = `nback_spat_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task pre-degree")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study predict BSL grades at the end of 2nd year?
nback_spat_grade_bsl_wide %>%
  ggplot(aes(x = `nback_spat_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study predict BSL grades at the end of 2nd year?
nback_spat_grade_bsl_wide %>%
  ggplot(aes(x = `nback_spat_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 2 years")
```


##### Combined accuracy
```{r nback_comb_grade_bsl}
# Create wider pivot table
nback_comb_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, nback_comb, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(nback_comb, grade_bsl))

# Does Combined Accuracy on the Dual N-Back Task pre-degree predict BSL grades at the end of 1st year?
nback_comb_grade_bsl_wide %>%
  ggplot(aes(x = `nback_comb_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 1 year of study predict BSL grades at the end of 1st year?
nback_comb_grade_bsl_wide %>%
  ggplot(aes(x = `nback_comb_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 2 years of study predict BSL grades at the end of 1st year?
nback_comb_grade_bsl_wide %>%
  ggplot(aes(x = `nback_comb_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task pre-degree predict BSL grades at the end of 2nd year?
nback_comb_grade_bsl_wide %>%
  ggplot(aes(x = `nback_comb_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 1 year of study predict BSL grades at the end of 2nd year?
nback_comb_grade_bsl_wide %>%
  ggplot(aes(x = `nback_comb_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 2 years of study predict BSL grades at the end of 2nd year?
nback_comb_grade_bsl_wide %>%
  ggplot(aes(x = `nback_comb_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

#### Corsi Blocks vs BSL Grades 

##### Block Span 
```{r corsi_bspan_grade_bsl}
# Create wider pivot table
corsi_bspan_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, corsi_bspan, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_bspan, grade_bsl))

# Does Block Span on the Corsi Blocks Task pre-degree predict BSL grades at the end of 1st year?
corsi_bspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_bspan_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 1st year?
corsi_bspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_bspan_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 1st year?
corsi_bspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_bspan_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Block Span on the Corsi Blocks Task pre-degree predict BSL grades at the end of 2nd year?
corsi_bspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_bspan_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 2nd year?
corsi_bspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_bspan_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 2nd year?
corsi_bspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_bspan_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Raw Score 
```{r corsi_score_grade_bsl}
# Create wider pivot table
corsi_score_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, corsi_score, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_score, grade_bsl))

# Does Raw Score on the Corsi Blocks Task pre-degree predict BSL grades at the end of 1st year?
corsi_score_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_score_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 1st year?
corsi_score_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_score_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 1st year?
corsi_score_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_score_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the Corsi Blocks Task pre-degree predict BSL grades at the end of 2nd year?
corsi_score_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_score_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 2nd year?
corsi_score_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_score_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 2nd year?
corsi_score_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_score_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Correct Responses 
```{r corsi_corr_grade_bsl}
# Create wider pivot table
corsi_corr_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, corsi_corr, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_corr, grade_bsl))

# Do Correct Responses on the Corsi Blocks Task pre-degree predict BSL grades at the end of 1st year?
corsi_corr_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_corr_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 1st year?
corsi_corr_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_corr_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 1st year?
corsi_corr_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_corr_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task pre-degree predict BSL grades at the end of 2nd year?
corsi_corr_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_corr_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 2nd year?
corsi_corr_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_corr_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 2nd year?
corsi_corr_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_corr_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Memory Span 
```{r corsi_mspan_grade_bsl}
# Create wider pivot table
corsi_mspan_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, corsi_mspan, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_mspan, grade_bsl))

# Does Memory Span on the Corsi Blocks Task pre-degree predict BSL grades at the end of 1st year?
corsi_mspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_mspan_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 1st year?
corsi_mspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_mspan_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 1st year?
corsi_mspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_mspan_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Memory Span on the Corsi Blocks Task pre-degree predict BSL grades at the end of 2nd year?
corsi_mspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_mspan_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 1 year of study predict BSL grades at the end of 2nd year?
corsi_mspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_mspan_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 2 years of study predict BSL grades at the end of 2nd year?
corsi_mspan_grade_bsl_wide %>%
  ggplot(aes(x = `corsi_mspan_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```


#### Kirklees Sentence Reading vs BSL Grades
##### Ceiling Score
```{r kirk_ceil_grade_bsl}
# Create wider pivot table
kirk_ceil_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, kirk_ceil, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kirk_ceil, grade_bsl))

# Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree predict BSL grades at the end of 1st year?
kirk_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_ceil_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study predict BSL grades at the end of 1st year?
kirk_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_ceil_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study predict BSL grades at the end of 1st year?
kirk_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_ceil_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree predict BSL grades at the end of 2nd year?
kirk_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_ceil_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study predict BSL grades at the end of 2nd year?
kirk_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_ceil_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study predict BSL grades at the end of 2nd year?
kirk_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_ceil_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Raw Score
```{r kirk_raw_grade_bsl}
# Create wider pivot table
kirk_raw_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, kirk_raw, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kirk_raw, grade_bsl))

# Does Raw Score on the Kirklees Sentence Reading Task pre-degree predict BSL grades at the end of 1st year?
kirk_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_raw_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study predict BSL grades at the end of 1st year?
kirk_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_raw_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study predict BSL grades at the end of 1st year?
kirk_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_raw_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task pre-degree predict BSL grades at the end of 2nd year?
kirk_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_raw_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study predict BSL grades at the end of 2nd year?
kirk_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_raw_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study predict BSL grades at the end of 2nd year?
kirk_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_raw_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Accuracy
```{r kirk_acc_grade_bsl}
# Create wider pivot table
kirk_acc_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, kirk_acc, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kirk_acc, grade_bsl))

# Does Accuracy on the Kirklees Sentence Reading Task pre-degree predict BSL grades at the end of 1st year?
kirk_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_acc_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the Kirklees Sentence Reading Task pre-degree")

# Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study predict BSL grades at the end of 1st year?
kirk_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_acc_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the Kirklees Sentence Reading Task after 1 year")

# Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study predict BSL grades at the end of 1st year?
kirk_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_acc_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the Kirklees Sentence Reading Task after 2 years")

# Does Accuracy on the Kirklees Sentence Reading Task pre-degree predict BSL grades at the end of 2nd year?
kirk_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_acc_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the Kirklees Sentence Reading Task pre-degree")

# Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study predict BSL grades at the end of 2nd year?
kirk_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_acc_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the Kirklees Sentence Reading Task after 1 year")

# Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study predict BSL grades at the end of 2nd year?
kirk_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kirk_acc_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the Kirklees Sentence Reading Task after 2 years")
```

###### Correlations
```{r}
kirk_acc_grade_bsl_wide %>% 
  filter(`kirk_acc_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_pre-degree`, 
                       `grade_bsl_1st year`))

kirk_acc_grade_bsl_wide %>% 
  filter(`kirk_acc_1st year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_1st year`, 
                       `grade_bsl_1st year`))

kirk_acc_grade_bsl_wide %>% 
  filter(`kirk_acc_2nd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%
  summarize(AccCOR=cor(`kirk_acc_2nd year`, 
                       `grade_bsl_1st year`))

kirk_acc_grade_bsl_wide %>% 
  filter(`kirk_acc_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_pre-degree`, 
                       `grade_bsl_2nd year`))

kirk_acc_grade_bsl_wide %>% 
  filter(`kirk_acc_1st year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_1st year`, 
                       `grade_bsl_2nd year`))

kirk_acc_grade_bsl_wide %>% 
  filter(`kirk_acc_2nd year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>%
  summarize(AccCOR=cor(`kirk_acc_2nd year`, 
                       `grade_bsl_2nd year`))
```

#### KBIT-2 Matrices vs BSL Grades
##### Ceiling Score
```{r kbit_ceil_grade_bsl}
# Create wider pivot table
kbit_ceil_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, kbit_ceil, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kbit_ceil, grade_bsl))

# Does Ceiling Score on the KBIT-2 Matrices Task pre-degree predict BSL grades at the end of 1st year?
kbit_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_ceil_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study predict BSL grades at the end of 1st year?
kbit_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_ceil_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study predict BSL grades at the end of 1st year?
kbit_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_ceil_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task pre-degree predict BSL grades at the end of 2nd year?
kbit_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_ceil_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study predict BSL grades at the end of 2nd year?
kbit_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_ceil_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study predict BSL grades at the end of 2nd year?
kbit_ceil_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_ceil_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Raw Score
```{r kbit_raw_grade_bsl}
# Create wider pivot table
kbit_raw_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, kbit_raw, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kbit_raw, grade_bsl))

# Does Raw Score on the KBIT-2 Matrices Task pre-degree predict BSL grades at the end of 1st year?
kbit_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_raw_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 1 year of study predict BSL grades at the end of 1st year?
kbit_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_raw_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 2 years of study predict BSL grades at the end of 1st year?
kbit_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_raw_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task pre-degree predict BSL grades at the end of 2nd year?
kbit_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_raw_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 1 year of study predict BSL grades at the end of 2nd year?
kbit_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_raw_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 2 years of study predict BSL grades at the end of 2nd year?
kbit_raw_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_raw_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Accuracy
```{r kbit_acc_grade_bsl}
# Create wider pivot table
kbit_acc_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, kbit_acc, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kbit_acc, grade_bsl))

# Does Accuracy on the KBIT-2 Matrices Task pre-degree predict BSL grades at the end of 1st year?
kbit_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_acc_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 1 year of study predict BSL grades at the end of 1st year?
kbit_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_acc_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 2 years of study predict BSL grades at the end of 1st year?
kbit_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_acc_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task pre-degree predict BSL grades at the end of 2nd year?
kbit_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_acc_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 1 year of study predict BSL grades at the end of 2nd year?
kbit_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_acc_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 2 years of study predict BSL grades at the end of 2nd year?
kbit_acc_grade_bsl_wide %>%
  ggplot(aes(x = `kbit_acc_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

#### Digit Span vs BSL Grades
##### Accuracy 
```{r dspan_acc_grade_bsl}
# Create wider pivot table
dspan_acc_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, dspan_corr, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(dspan_corr, grade_bsl))

# Does Accuracy on the Digit Span Task pre-degree predict BSL grades at the end of 1st year?
dspan_acc_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_corr_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Accuracy on the Digit Span Task after 1 year of study predict BSL grades at the end of 1st year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Accuracy on the Digit Span Task after 2 years of study predict BSL grades at the end of 1st year?
dspan_acc_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_corr_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Accuracy on the Digit Span Task pre-degree predict BSL grades at the end of 2nd year?
dspan_acc_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_corr_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Accuracy on the Digit Span Task after 1 year of study predict BSL grades at the end of 2nd year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Accuracy on the Digit Span Task after 2 years of study predict BSL grades at the end of 2nd year?
dspan_acc_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_corr_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Memory Span 
```{r dspan_mem_grade_bsl}
# Create wider pivot table
dspan_mem_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, dspan_mem, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(dspan_mem, grade_bsl))

# Does Memory Span on the Digit Span Task pre-degree predict BSL grades at the end of 1st year?
dspan_mem_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_mem_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Memory Span on the Digit Span Task after 1 year of study predict BSL grades at the end of 1st year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Memory Span on the Digit Span Task after 2 years of study predict BSL grades at the end of 1st year?
dspan_mem_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_mem_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Memory Span on the Digit Span Task pre-degree predict BSL grades at the end of 2nd year?
dspan_mem_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_mem_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Memory Span on the Digit Span Task after 1 year of study predict BSL grades at the end of 2nd year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Memory Span on the Digit Span Task after 2 years of study predict BSL grades at the end of 2nd year?
dspan_mem_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_mem_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

```{r dspan_time_grade_bsl}
# Create wider pivot table
dspan_time_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, dspan_time, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(dspan_time, grade_bsl))

# Does Time spent on the Digit Span Task pre-degree predict BSL grades at the end of 1st year?
dspan_time_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_time_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Time spent on the Digit Span Task after 1 year of study predict BSL grades at the end of 1st year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Time spent on the Digit Span Task after 2 years of study predict BSL grades at the end of 1st year?
dspan_time_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_time_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Time spent on the Digit Span Task pre-degree predict BSL grades at the end of 2nd year?
dspan_time_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_time_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Time spent on the Digit Span Task after 1 year of study predict BSL grades at the end of 2nd year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Time spent on the Digit Span Task after 2 years of study predict BSL grades at the end of 2nd year?
dspan_time_grade_bsl_wide %>%
  ggplot(aes(x = `dspan_time_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

#### 2D Mental Rotation vs BSL Grades
##### Accuracy 
```{r mr2d_acc_grade_bsl}
# Create wider pivot table
mr2d_acc_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, mr2d_acc, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr2d_acc, grade_bsl))

# Does Accuracy on the 2D Mental Rotation Task pre-degree predict BSL grades at the end of 1st year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the 2D Mental Rotation Task pre-degree")

# Does Accuracy on the 2D Mental Rotation Task after 1 year of study predict BSL grades at the end of 1st year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the 2D Mental Rotation Task after 1 year of study")

# Does Accuracy on the 2D Mental Rotation Task after 2 years of study predict BSL grades at the end of 1st year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the 2D Mental Rotation Task after 2 years of study")

# Does Accuracy on the 2D Mental Rotation Task after 3 years of study predict BSL grades at the end of 1st year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_3rd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the 2D Mental Rotation Task after 3 years of study")

# Does Accuracy on the 2D Mental Rotation Task pre-degree predict BSL grades at the end of 2nd year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the 2D Mental Rotation Task pre-degree")

# Does Accuracy on the 2D Mental Rotation Task after 1 year of study predict BSL grades at the end of 2nd year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the 2D Mental Rotation Task after 1 year of study")

# Does Accuracy on the 2D Mental Rotation Task after 2 years of study predict BSL grades at the end of 2nd year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the 2D Mental Rotation Task after 2 years of study")

# Does Accuracy on the 2D Mental Rotation Task after 3 years of study predict BSL grades at the end of 2nd year?
mr2d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_acc_3rd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the 2D Mental Rotation Task after 3 years of study")
```
###### Correlations
```{r}
mr2d_acc_grade_bsl_wide %>% 
  filter(`mr2d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_pre-degree`, 
                       `grade_bsl_1st year`))

mr2d_acc_grade_bsl_wide %>% 
  filter(`mr2d_acc_1st year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_1st year`, 
                       `grade_bsl_1st year`))

mr2d_acc_grade_bsl_wide %>% 
  filter(`mr2d_acc_2nd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%   summarize(AccCOR=cor(`mr2d_acc_2nd year`, 
                       `grade_bsl_1st year`))

mr2d_acc_grade_bsl_wide %>% 
  filter(`mr2d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_pre-degree`, 
                       `grade_bsl_2nd year`))

mr2d_acc_grade_bsl_wide %>% 
  filter(`mr2d_acc_1st year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_1st year`, 
                       `grade_bsl_2nd year`))

mr2d_acc_grade_bsl_wide %>% 
  filter(`mr2d_acc_2nd year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>%   summarize(AccCOR=cor(`mr2d_acc_2nd year`, 
                       `grade_bsl_2nd year`))
```


##### RT 
```{r mr2d_rt_grade_bsl}
# Create wider pivot table
mr2d_rt_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, mr2d_rt, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr2d_rt, grade_bsl))

# Does Reaction Time on the 2D Mental Rotation Task pre-degree predict BSL grades at the end of 1st year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 1 year of study predict BSL grades at the end of 1st year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_1st year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 1 year of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 2 years of study predict BSL grades at the end of 1st year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 3 years of study predict BSL grades at the end of 1st year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_3rd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task pre-degree predict BSL grades at the end of 2nd year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 1 year of study predict BSL grades at the end of 2nd year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_1st year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 1 year of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 2 years of study predict BSL grades at the end of 2nd year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 3 years of study predict BSL grades at the end of 2nd year?
mr2d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr2d_rt_3rd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

###### Correlations
```{r}
mr2d_rt_grade_bsl_wide %>% 
  filter(`mr2d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_pre-degree`, 
                       `grade_bsl_1st year`))
# strongly driven by an outlier

mr2d_rt_grade_bsl_wide %>% 
  filter(`mr2d_rt_1st year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_1st year`, 
                       `grade_bsl_1st year`))
# strongly driven by an outlier

mr2d_rt_grade_bsl_wide %>% 
  filter(`mr2d_rt_2nd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%  
  summarize(rtCOR=cor(`mr2d_rt_2nd year`, 
                       `grade_bsl_1st year`))

mr2d_rt_grade_bsl_wide %>% 
  filter(`mr2d_rt_3rd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%  
  summarize(rtCOR=cor(`mr2d_rt_3rd year`, 
                       `grade_bsl_1st year`))

mr2d_rt_grade_bsl_wide %>% 
  filter(`mr2d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_pre-degree`, 
                       `grade_bsl_2nd year`))

mr2d_rt_grade_bsl_wide %>% 
  filter(`mr2d_rt_1st year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_1st year`, 
                       `grade_bsl_2nd year`))

mr2d_rt_grade_bsl_wide %>% 
  filter(`mr2d_rt_2nd year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>%  
  summarize(rtCOR=cor(`mr2d_rt_2nd year`, 
                       `grade_bsl_2nd year`))


```

#### 3D Mental Rotation vs BSL Grades
##### Accuracy 
```{r mr3d_acc_grade_bsl}
# Create wider pivot table
mr3d_acc_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, mr3d_acc, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr3d_acc, grade_bsl))

# Does Accuracy on the 3D Mental Rotation Task pre-degree predict BSL grades at the end of 1st year?
mr3d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_acc_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 3D Mental Rotation Task pre-degree\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the 3D Mental Rotation Task pre-degree")

# Does Accuracy on the 3D Mental Rotation Task after 1 year of study predict BSL grades at the end of 1st year?
# mr3d_acc_grade_bsl_wide %>%
#  ggplot(aes(x = `mr3d_acc_1st year`, y = `grade_bsl_1st year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()  # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Accuracy on the 3D Mental Rotation Task after 2 years of study predict BSL grades at the end of 1st year?
mr3d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_acc_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the 3D Mental Rotation Task after 2 years")

# Does Accuracy on the 3D Mental Rotation Task after 3 years of study predict BSL grades at the end of 1st year?
mr3d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_acc_3rd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Accuracy on the 3D Mental Rotation Task after 3 years")

# Does Accuracy on the 3D Mental Rotation Task pre-degree predict BSL grades at the end of 2nd year?
mr3d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_acc_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the 3D Mental Rotation Task pre-degree") 

# Does Accuracy on the 3D Mental Rotation Task after 1 year of study predict BSL grades at the end of 2nd year?
# mr3d_acc_grade_bsl_wide %>%
#  ggplot(aes(x = `mr3d_acc_1st year`, y = `grade_bsl_2nd year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()  # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Accuracy on the 3D Mental Rotation Task after 2 years of study predict BSL grades at the end of 2nd year?
mr3d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_acc_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the 3D Mental Rotation Task after 2 years") 

# Does Accuracy on the 3D Mental Rotation Task after 3 years of study predict BSL grades at the end of 2nd year?
mr3d_acc_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_acc_3rd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Accuracy on the 3D Mental Rotation Task after 3 years") 
```
###### Correlations
```{r}
mr3d_acc_grade_bsl_wide %>% 
  filter(`mr3d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`mr3d_acc_pre-degree`, 
                       `grade_bsl_1st year`))

mr3d_acc_grade_bsl_wide %>% 
  filter(`mr3d_acc_2nd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%   
  summarize(AccCOR=cor(`mr3d_acc_2nd year`, 
                       `grade_bsl_1st year`))

mr3d_acc_grade_bsl_wide %>% 
  filter(`mr3d_acc_3rd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%   
  summarize(AccCOR=cor(`mr3d_acc_3rd year`, 
                       `grade_bsl_1st year`))

mr3d_acc_grade_bsl_wide %>% 
  filter(`mr3d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`mr3d_acc_pre-degree`, 
                       `grade_bsl_2nd year`))

mr3d_acc_grade_bsl_wide %>% 
  filter(`mr3d_acc_2nd year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>%   
  summarize(AccCOR=cor(`mr3d_acc_2nd year`, 
                       `grade_bsl_2nd year`))

mr3d_acc_grade_bsl_wide %>% 
  filter(`mr3d_acc_3rd year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>%   
  summarize(AccCOR=cor(`mr3d_acc_3rd year`, 
                       `grade_bsl_2nd year`))
```

##### RT 
```{r mr3d_rt_grade_bsl}
# Create wider pivot table
mr3d_rt_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, mr3d_rt, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr3d_rt, grade_bsl))

# Does Reaction Time on the 3D Mental Rotation Task pre-degree predict BSL grades at the end of 1st year?
mr3d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_rt_pre-degree`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal()+
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Reaction Time on the 3D Mental Rotation Task pre-degree") 

# Does Reaction Time on the 3D Mental Rotation Task after 1 year of study predict BSL grades at the end of 1st year?
# mr3d_rt_grade_bsl_wide %>%
#  ggplot(aes(x = `mr3d_rt_1st year`, y = `grade_bsl_1st year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()  # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Reaction Time on the 3D Mental Rotation Task after 2 years of study predict BSL grades at the end of 1st year?
mr3d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_rt_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal()+
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Reaction Time on the 3D Mental Rotation Task after 2 year of study") 

# Does Reaction Time on the 3D Mental Rotation Task after 3 years of study predict BSL grades at the end of 1st year?
mr3d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_rt_3rd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal()+
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 1st year?", y = "1st year BSL grade", x = "Reaction Time on the 3D Mental Rotation Task after 3 year of study")

# Does Reaction Time on the 3D Mental Rotation Task pre-degree predict BSL grades at the end of 2nd year?
mr3d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_rt_pre-degree`, y = `grade_bsl_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal()+
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task pre-degree\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Reaction Time on the 3D Mental Rotation Task pre-degree") 

# Does Reaction Time on the 3D Mental Rotation Task after 1 year of study predict BSL grades at the end of 2nd year?
# mr3d_rt_grade_bsl_wide %>%
#  ggplot(aes(x = `mr3d_rt_1st year`, y = `grade_bsl_2nd year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()   # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Reaction Time on the 3D Mental Rotation Task after 2 years of study predict BSL grades at the end of 2nd year?
mr3d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_rt_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Reaction Time on the 3D Mental Rotation Task after 2 years of study") 

# Does Reaction Time on the 3D Mental Rotation Task after 3 years of study predict BSL grades at the end of 2nd year?
mr3d_rt_grade_bsl_wide %>%
  ggplot(aes(x = `mr3d_rt_3rd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task after 3 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = "Reaction Time on the 3D Mental Rotation Task after 3 years of study") 
```
###### Correlations
```{r}
mr3d_rt_grade_bsl_wide %>% 
  filter(`mr3d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>% 
  summarize(rtCOR=cor(`mr3d_rt_pre-degree`, 
                       `grade_bsl_1st year`))

mr3d_rt_grade_bsl_wide %>% 
  filter(`mr3d_rt_2nd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%   
  summarize(rtCOR=cor(`mr3d_rt_2nd year`, 
                       `grade_bsl_1st year`))

mr3d_rt_grade_bsl_wide %>% 
  filter(`mr3d_rt_3rd year`!= "NA") %>% 
  filter(`grade_bsl_1st year` != "NA") %>%   
  summarize(rtCOR=cor(`mr3d_rt_3rd year`, 
                       `grade_bsl_1st year`))

mr3d_rt_grade_bsl_wide %>% 
  filter(`mr3d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>% 
  summarize(rtCOR=cor(`mr3d_rt_pre-degree`, 
                       `grade_bsl_2nd year`))

mr3d_rt_grade_bsl_wide %>% 
  filter(`mr3d_rt_2nd year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>%   
  summarize(rtCOR=cor(`mr3d_rt_2nd year`, 
                       `grade_bsl_2nd year`))

mr3d_rt_grade_bsl_wide %>% 
  filter(`mr3d_rt_3rd year`!= "NA") %>% 
  filter(`grade_bsl_2nd year` != "NA") %>%   
  summarize(rtCOR=cor(`mr3d_rt_3rd year`, 
                       `grade_bsl_2nd year`))
```

#### Barratt Impulsiveness Scale vs BSL Grades

##### Total Impulsiveness 
```{r bis_tot_grade_bsl}
# Create wider pivot table
bis_tot_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, bis_tot, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_tot, grade_bsl))

# Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study predict BSL grades at the end of 1st year?
bis_tot_grade_bsl_wide %>%
  filter(`bis_tot_2nd year` != "na") %>% 
  filter(`grade_bsl_1st year` != "na") %>% 
  ggplot(aes(x = `bis_tot_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study predict BSL grades at the end of 2nd year?
bis_tot_grade_bsl_wide %>%
  filter(`bis_tot_2nd year` != "na") %>% 
  filter(`grade_bsl_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_tot_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

Not sure why geom_smooth() line does not appear in knitted output (works in .Rmd file)

##### Attentional Impulsiveness
```{r bis_att_grade_bsl}
# Create wider pivot table
bis_att_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, bis_att, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_att, grade_bsl))

# Does Attentional Impulsiveness after 2 years predict BSL grades at the end of 1st year?
bis_att_grade_bsl_wide %>%
  filter(`bis_att_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_att_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Attentional Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Attentional Impulsiveness after 2 years predict BSL grades at the end of 2nd year?
bis_att_grade_bsl_wide %>%
  filter(`bis_att_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_att_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Attentional Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Motor Impulsiveness
```{r bis_nplan_grade_bsl}
# Create wider pivot table
bis_nplan_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, bis_nplan, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_nplan, grade_bsl))

# Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict BSL grades at the end of 1st year?
bis_nplan_grade_bsl_wide %>%
  filter(`bis_nplan_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_nplan_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict BSL grades at the end of 2nd year?
bis_nplan_grade_bsl_wide %>%
  filter(`bis_nplan_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_nplan_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

##### Non-Planning Impulsiveness
```{r bis_mot_grade_bsl}
# Create wider pivot table
bis_mot_grade_bsl_wide <- apt %>% 
  select(session, group, ppt, bis_mot, grade_bsl) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_mot, grade_bsl))

# Does Non-PLanning Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict BSL grades at the end of 1st year?
bis_mot_grade_bsl_wide %>%
  filter(`bis_mot_2nd year` != "NA") %>% 
  ggplot(aes(x = `bis_mot_2nd year`, y = `grade_bsl_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Non-Planning Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")

# Does Non-PLanning Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict BSL grades at the end of 2nd year?
bis_mot_grade_bsl_wide %>%
  filter(`bis_mot_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_mot_2nd year`, y = `grade_bsl_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Non-Planning Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict BSL grades at the end of 2nd year?", y = "2nd year BSL grade", x = " ")
```

### Effects of predictors on Interpreting Grades

#### Dual N-Back vs Interpreting Grades
##### Accuracy in Letter Matching
```{r nback_lett_grade_terp}
# Create wider pivot table
nback_lett_grade_terp_wide <- apt %>% 
  select(session, group, ppt, nback_lett, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(nback_lett, grade_terp))

# Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree predict Interpreting Grades at the end of 1st year?
nback_lett_grade_terp_wide %>%
  ggplot(aes(x = `nback_lett_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy in Letter Matching on the Dual N-Back Task pre-degree")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study predict Interpreting Grades at the end of 1st year?
nback_lett_grade_terp_wide %>%
  ggplot(aes(x = `nback_lett_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study predict Interpreting Grades at the end of 1st year?
nback_lett_grade_terp_wide %>%
  ggplot(aes(x = `nback_lett_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 2 years")

# Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree predict Interpreting Grades at the end of 2nd year?
nback_lett_grade_terp_wide %>%
  ggplot(aes(x = `nback_lett_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy in Letter Matching on the Dual N-Back Task pre-degree")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
nback_lett_grade_terp_wide %>%
  ggplot(aes(x = `nback_lett_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
nback_lett_grade_terp_wide %>%
  ggplot(aes(x = `nback_lett_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Letter Matching on the Dual N-Back Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy in Letter Matching on the Dual N-Back Task after 2 years")
```

##### Accuracy in Spatial Matching
```{r nback_spat_grade_terp}
# Create wider pivot table
nback_spat_grade_terp_wide <- apt %>% 
  select(session, group, ppt, nback_spat, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(nback_spat, grade_terp))

# Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree predict Interpreting Grades at the end of 1st year?
nback_spat_grade_terp_wide %>%
  ggplot(aes(x = `nback_spat_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task pre-degre")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study predict Interpreting Grades at the end of 1st year?
nback_spat_grade_terp_wide %>%
  ggplot(aes(x = `nback_spat_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study predict Interpreting Grades at the end of 1st year?
nback_spat_grade_terp_wide %>%
  ggplot(aes(x = `nback_spat_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 2 years")

# Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree predict Interpreting Grades at the end of 2nd year?
nback_spat_grade_terp_wide %>%
  ggplot(aes(x = `nback_spat_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task pre-degree")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
nback_spat_grade_terp_wide %>%
  ggplot(aes(x = `nback_spat_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 1 year")

# Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
nback_spat_grade_terp_wide %>%
  ggplot(aes(x = `nback_spat_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy in Spatial Matching on the Dual N-Back Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy in Spatial Matching on the Dual N-Back Task after 2 years")
```


##### Combined accuracy
```{r nback_comb_grade_terp}
# Create wider pivot table
nback_comb_grade_terp_wide <- apt %>% 
  select(session, group, ppt, nback_comb, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(nback_comb, grade_terp))

# Does Combined Accuracy on the Dual N-Back Task pre-degree predict Interpreting Grades at the end of 1st year?
nback_comb_grade_terp_wide %>%
  ggplot(aes(x = `nback_comb_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 1 year of study predict Interpreting Grades at the end of 1st year?
nback_comb_grade_terp_wide %>%
  ggplot(aes(x = `nback_comb_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 2 years of study predict Interpreting Grades at the end of 1st year?
nback_comb_grade_terp_wide %>%
  ggplot(aes(x = `nback_comb_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task pre-degree predict Interpreting Grades at the end of 2nd year?
nback_comb_grade_terp_wide %>%
  ggplot(aes(x = `nback_comb_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
nback_comb_grade_terp_wide %>%
  ggplot(aes(x = `nback_comb_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Combined Accuracy on the Dual N-Back Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
nback_comb_grade_terp_wide %>%
  ggplot(aes(x = `nback_comb_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Combined Accuracy on the Dual N-Back Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```
###### Correlations
```{r}
nback_comb_grade_terp_wide %>% 
  filter(`nback_comb_pre-degree`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`nback_comb_pre-degree`, 
                       `grade_terp_1st year`))

nback_comb_grade_terp_wide %>% 
  filter(`nback_comb_1st year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`nback_comb_1st year`, 
                       `grade_terp_1st year`))

nback_comb_grade_terp_wide %>% 
  filter(`nback_comb_2nd year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>%   summarize(AccCOR=cor(`nback_comb_2nd year`, 
                       `grade_terp_1st year`))

nback_comb_grade_terp_wide %>% 
  filter(`nback_comb_pre-degree`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`nback_comb_pre-degree`, 
                       `grade_terp_2nd year`))

nback_comb_grade_terp_wide %>% 
  filter(`nback_comb_1st year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`nback_comb_1st year`, 
                       `grade_terp_2nd year`))

nback_comb_grade_terp_wide %>% 
  filter(`nback_comb_2nd year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>%   summarize(AccCOR=cor(`nback_comb_2nd year`, 
                       `grade_terp_2nd year`))
```

#### Corsi Blocks vs Interpreting Grades 

##### Block Span 
```{r corsi_bspan_grade_terp}
# Create wider pivot table
corsi_bspan_grade_terp_wide <- apt %>% 
  select(session, group, ppt, corsi_bspan, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_bspan, grade_terp))

# Does Block Span on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 1st year?
corsi_bspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_bspan_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 1st year?
corsi_bspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_bspan_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 1st year?
corsi_bspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_bspan_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Block Span on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 2nd year?
corsi_bspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_bspan_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
corsi_bspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_bspan_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Block Span on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
corsi_bspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_bspan_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Block Span on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Raw Score 
```{r corsi_score_grade_terp}
# Create wider pivot table
corsi_score_grade_terp_wide <- apt %>% 
  select(session, group, ppt, corsi_score, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_score, grade_terp))

# Does Raw Score on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 1st year?
corsi_score_grade_terp_wide %>%
  ggplot(aes(x = `corsi_score_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 1st year?
corsi_score_grade_terp_wide %>%
  ggplot(aes(x = `corsi_score_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 1st year?
corsi_score_grade_terp_wide %>%
  ggplot(aes(x = `corsi_score_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 2nd year?
corsi_score_grade_terp_wide %>%
  ggplot(aes(x = `corsi_score_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
corsi_score_grade_terp_wide %>%
  ggplot(aes(x = `corsi_score_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Raw Score on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
corsi_score_grade_terp_wide %>%
  ggplot(aes(x = `corsi_score_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Correct Responses 
```{r corsi_corr_grade_terp}
# Create wider pivot table
corsi_corr_grade_terp_wide <- apt %>% 
  select(session, group, ppt, corsi_corr, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_corr, grade_terp))

# Do Correct Responses on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 1st year?
corsi_corr_grade_terp_wide %>%
  ggplot(aes(x = `corsi_corr_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 1st year?
corsi_corr_grade_terp_wide %>%
  ggplot(aes(x = `corsi_corr_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 1st year?
corsi_corr_grade_terp_wide %>%
  ggplot(aes(x = `corsi_corr_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 2nd year?
corsi_corr_grade_terp_wide %>%
  ggplot(aes(x = `corsi_corr_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
corsi_corr_grade_terp_wide %>%
  ggplot(aes(x = `corsi_corr_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Do Correct Responses on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
corsi_corr_grade_terp_wide %>%
  ggplot(aes(x = `corsi_corr_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Do Correct Responses on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Memory Span 
```{r corsi_mspan_grade_terp}
# Create wider pivot table
corsi_mspan_grade_terp_wide <- apt %>% 
  select(session, group, ppt, corsi_mspan, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(corsi_mspan, grade_terp))

# Does Memory Span on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 1st year?
corsi_mspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_mspan_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 1st year?
corsi_mspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_mspan_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 1st year?
corsi_mspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_mspan_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Memory Span on the Corsi Blocks Task pre-degree predict Interpreting Grades at the end of 2nd year?
corsi_mspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_mspan_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
corsi_mspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_mspan_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Memory Span on the Corsi Blocks Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
corsi_mspan_grade_terp_wide %>%
  ggplot(aes(x = `corsi_mspan_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Corsi Blocks Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```


#### Kirklees Sentence Reading vs Interpreting Grades
##### Ceiling Score
```{r kirk_ceil_grade_terp}
# Create wider pivot table
kirk_ceil_grade_terp_wide <- apt %>% 
  select(session, group, ppt, kirk_ceil, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kirk_ceil, grade_terp))

# Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree predict Interpreting Grades at the end of 1st year?
kirk_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kirk_ceil_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study predict Interpreting Grades at the end of 1st year?
kirk_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kirk_ceil_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study predict Interpreting Grades at the end of 1st year?
kirk_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kirk_ceil_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree predict Interpreting Grades at the end of 2nd year?
kirk_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kirk_ceil_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
kirk_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kirk_ceil_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
kirk_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kirk_ceil_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the Kirklees Sentence Reading Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Raw Score
```{r kirk_raw_grade_terp}
# Create wider pivot table
kirk_raw_grade_terp_wide <- apt %>% 
  select(session, group, ppt, kirk_raw, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kirk_raw, grade_terp))

# Does Raw Score on the Kirklees Sentence Reading Task pre-degree predict Interpreting Grades at the end of 1st year?
kirk_raw_grade_terp_wide %>%
  ggplot(aes(x = `kirk_raw_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study predict Interpreting Grades at the end of 1st year?
kirk_raw_grade_terp_wide %>%
  ggplot(aes(x = `kirk_raw_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study predict Interpreting Grades at the end of 1st year?
kirk_raw_grade_terp_wide %>%
  ggplot(aes(x = `kirk_raw_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task pre-degree predict Interpreting Grades at the end of 2nd year?
kirk_raw_grade_terp_wide %>%
  ggplot(aes(x = `kirk_raw_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
kirk_raw_grade_terp_wide %>%
  ggplot(aes(x = `kirk_raw_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
kirk_raw_grade_terp_wide %>%
  ggplot(aes(x = `kirk_raw_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the Kirklees Sentence Reading Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Accuracy
```{r kirk_acc_grade_terp}
# Create wider pivot table
kirk_acc_grade_terp_wide <- apt %>% 
  select(session, group, ppt, kirk_acc, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kirk_acc, grade_terp))

# Does Accuracy on the Kirklees Sentence Reading Task pre-degree predict Interpreting Grades at the end of 1st year?
kirk_acc_grade_terp_wide %>%
  ggplot(aes(x = `kirk_acc_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the Kirklees Sentence Reading Task pre-degree")

# Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study predict Interpreting Grades at the end of 1st year?
kirk_acc_grade_terp_wide %>%
  ggplot(aes(x = `kirk_acc_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the Kirklees Sentence Reading Task after 1 year")

# Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study predict Interpreting Grades at the end of 1st year?
kirk_acc_grade_terp_wide %>%
  ggplot(aes(x = `kirk_acc_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the Kirklees Sentence Reading Task after 2 years")

# Does Accuracy on the Kirklees Sentence Reading Task pre-degree predict Interpreting Grades at the end of 2nd year?
kirk_acc_grade_terp_wide %>%
  ggplot(aes(x = `kirk_acc_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the Kirklees Sentence Reading Task pre-degree")

# Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
kirk_acc_grade_terp_wide %>%
  ggplot(aes(x = `kirk_acc_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the Kirklees Sentence Reading Task after 1 year")

# Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
kirk_acc_grade_terp_wide %>%
  ggplot(aes(x = `kirk_acc_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the Kirklees Sentence Reading Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the Kirklees Sentence Reading Task after 2 years")
```

###### Correlations
```{r}
kirk_acc_grade_terp_wide %>% 
  filter(`kirk_acc_pre-degree`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_pre-degree`, 
                       `grade_terp_1st year`))

kirk_acc_grade_terp_wide %>% 
  filter(`kirk_acc_1st year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_1st year`, 
                       `grade_terp_1st year`))

kirk_acc_grade_terp_wide %>% 
  filter(`kirk_acc_2nd year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>%
  summarize(AccCOR=cor(`kirk_acc_2nd year`, 
                       `grade_terp_1st year`))

kirk_acc_grade_terp_wide %>% 
  filter(`kirk_acc_pre-degree`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_pre-degree`, 
                       `grade_terp_2nd year`))

kirk_acc_grade_terp_wide %>% 
  filter(`kirk_acc_1st year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`kirk_acc_1st year`, 
                       `grade_terp_2nd year`))

kirk_acc_grade_terp_wide %>% 
  filter(`kirk_acc_2nd year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>%
  summarize(AccCOR=cor(`kirk_acc_2nd year`, 
                       `grade_terp_2nd year`))
```

#### KBIT-2 Matrices vs Interpreting Grades
##### Ceiling Score
```{r kbit_ceil_grade_terp}
# Create wider pivot table
kbit_ceil_grade_terp_wide <- apt %>% 
  select(session, group, ppt, kbit_ceil, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kbit_ceil, grade_terp))

# Does Ceiling Score on the KBIT-2 Matrices Task pre-degree predict Interpreting Grades at the end of 1st year?
kbit_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kbit_ceil_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study predict Interpreting Grades at the end of 1st year?
kbit_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kbit_ceil_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study predict Interpreting Grades at the end of 1st year?
kbit_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kbit_ceil_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task pre-degree predict Interpreting Grades at the end of 2nd year?
kbit_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kbit_ceil_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
kbit_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kbit_ceil_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
kbit_ceil_grade_terp_wide %>%
  ggplot(aes(x = `kbit_ceil_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Ceiling Score on the KBIT-2 Matrices Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Raw Score
```{r kbit_raw_grade_terp}
# Create wider pivot table
kbit_raw_grade_terp_wide <- apt %>% 
  select(session, group, ppt, kbit_raw, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kbit_raw, grade_terp))

# Does Raw Score on the KBIT-2 Matrices Task pre-degree predict Interpreting Grades at the end of 1st year?
kbit_raw_grade_terp_wide %>%
  ggplot(aes(x = `kbit_raw_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 1 year of study predict Interpreting Grades at the end of 1st year?
kbit_raw_grade_terp_wide %>%
  ggplot(aes(x = `kbit_raw_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 2 years of study predict Interpreting Grades at the end of 1st year?
kbit_raw_grade_terp_wide %>%
  ggplot(aes(x = `kbit_raw_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task pre-degree predict Interpreting Grades at the end of 2nd year?
kbit_raw_grade_terp_wide %>%
  ggplot(aes(x = `kbit_raw_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
kbit_raw_grade_terp_wide %>%
  ggplot(aes(x = `kbit_raw_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Raw Score on the KBIT-2 Matrices Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
kbit_raw_grade_terp_wide %>%
  ggplot(aes(x = `kbit_raw_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Raw Score on the KBIT-2 Matrices Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Accuracy
```{r kbit_acc_grade_terp}
# Create wider pivot table
kbit_acc_grade_terp_wide <- apt %>% 
  select(session, group, ppt, kbit_acc, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(kbit_acc, grade_terp))

# Does Accuracy on the KBIT-2 Matrices Task pre-degree predict Interpreting Grades at the end of 1st year?
kbit_acc_grade_terp_wide %>%
  ggplot(aes(x = `kbit_acc_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 1 year of study predict Interpreting Grades at the end of 1st year?
kbit_acc_grade_terp_wide %>%
  ggplot(aes(x = `kbit_acc_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 2 years of study predict Interpreting Grades at the end of 1st year?
kbit_acc_grade_terp_wide %>%
  ggplot(aes(x = `kbit_acc_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task pre-degree predict Interpreting Grades at the end of 2nd year?
kbit_acc_grade_terp_wide %>%
  ggplot(aes(x = `kbit_acc_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
kbit_acc_grade_terp_wide %>%
  ggplot(aes(x = `kbit_acc_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Accuracy on the KBIT-2 Matrices Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
kbit_acc_grade_terp_wide %>%
  ggplot(aes(x = `kbit_acc_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the KBIT-2 Matrices Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

#### Digit Span vs Interpreting Grades
##### Accuracy 
```{r dspan_acc_grade_terp}
# Create wider pivot table
dspan_acc_grade_terp_wide <- apt %>% 
  select(session, group, ppt, dspan_corr, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(dspan_corr, grade_terp))

# Does Accuracy on the Digit Span Task pre-degree predict Interpreting Grades at the end of 1st year?
dspan_acc_grade_terp_wide %>%
  ggplot(aes(x = `dspan_corr_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Accuracy on the Digit Span Task after 1 year of study predict Interpreting Grades at the end of 1st year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Accuracy on the Digit Span Task after 2 years of study predict Interpreting Grades at the end of 1st year?
dspan_acc_grade_terp_wide %>%
  ggplot(aes(x = `dspan_corr_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Accuracy on the Digit Span Task pre-degree predict Interpreting Grades at the end of 2nd year?
dspan_acc_grade_terp_wide %>%
  ggplot(aes(x = `dspan_corr_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Accuracy on the Digit Span Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Accuracy on the Digit Span Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
dspan_acc_grade_terp_wide %>%
  ggplot(aes(x = `dspan_corr_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Accuracy on the Digit Span Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

###### Correlations
```{r}
dspan_acc_grade_terp_wide %>% 
  filter(`dspan_corr_pre-degree`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`dspan_corr_pre-degree`, 
                       `grade_terp_1st year`))

dspan_acc_grade_terp_wide %>% 
  filter(`dspan_corr_2nd year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>%
  summarize(AccCOR=cor(`dspan_corr_2nd year`, 
                       `grade_terp_1st year`))

dspan_acc_grade_terp_wide %>% 
  filter(`dspan_corr_pre-degree`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`dspan_corr_pre-degree`, 
                       `grade_terp_2nd year`))

dspan_acc_grade_terp_wide %>% 
  filter(`dspan_corr_2nd year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>%
  summarize(AccCOR=cor(`dspan_corr_2nd year`, 
                       `grade_terp_2nd year`))
```

##### Memory Span 
```{r dspan_mem_grade_terp}
# Create wider pivot table
dspan_mem_grade_terp_wide <- apt %>% 
  select(session, group, ppt, dspan_mem, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(dspan_mem, grade_terp))

# Does Memory Span on the Digit Span Task pre-degree predict Interpreting Grades at the end of 1st year?
dspan_mem_grade_terp_wide %>%
  ggplot(aes(x = `dspan_mem_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Memory Span on the Digit Span Task after 1 year of study predict Interpreting Grades at the end of 1st year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Memory Span on the Digit Span Task after 2 years of study predict Interpreting Grades at the end of 1st year?
dspan_mem_grade_terp_wide %>%
  ggplot(aes(x = `dspan_mem_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Memory Span on the Digit Span Task pre-degree predict Interpreting Grades at the end of 2nd year?
dspan_mem_grade_terp_wide %>%
  ggplot(aes(x = `dspan_mem_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Memory Span on the Digit Span Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Memory Span on the Digit Span Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
dspan_mem_grade_terp_wide %>%
  ggplot(aes(x = `dspan_mem_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Memory Span on the Digit Span Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

```{r dspan_time_grade_terp}
# Create wider pivot table
dspan_time_grade_terp_wide <- apt %>% 
  select(session, group, ppt, dspan_time, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(dspan_time, grade_terp))

# Does Time spent on the Digit Span Task pre-degree predict Interpreting Grades at the end of 1st year?
dspan_time_grade_terp_wide %>%
  ggplot(aes(x = `dspan_time_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Time spent on the Digit Span Task after 1 year of study predict Interpreting Grades at the end of 1st year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Time spent on the Digit Span Task after 2 years of study predict Interpreting Grades at the end of 1st year?
dspan_time_grade_terp_wide %>%
  ggplot(aes(x = `dspan_time_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Time spent on the Digit Span Task pre-degree predict Interpreting Grades at the end of 2nd year?
dspan_time_grade_terp_wide %>%
  ggplot(aes(x = `dspan_time_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Time spent on the Digit Span Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
# removing bc no datapoints for Digit Span @ timepoint 2

# Does Time spent on the Digit Span Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
dspan_time_grade_terp_wide %>%
  ggplot(aes(x = `dspan_time_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Time spent on the Digit Span Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

#### 2D Mental Rotation vs Interpreting Grades
##### Accuracy 
```{r mr2d_acc_grade_terp}
# Create wider pivot table
mr2d_acc_grade_terp_wide <- apt %>% 
  select(session, group, ppt, mr2d_acc, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr2d_acc, grade_terp))

# Does Accuracy on the 2D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 1st year?
mr2d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_acc_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the 2D Mental Rotation Task pre-degree")

# Does Accuracy on the 2D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 1st year?
mr2d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_acc_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the 2D Mental Rotation Task after 1 year of study")

# Does Accuracy on the 2D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 1st year?
mr2d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_acc_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the 2D Mental Rotation Task after 2 years of study")

# Does Accuracy on the 2D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 2nd year?
mr2d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_acc_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the 2D Mental Rotation Task pre-degree")

# Does Accuracy on the 2D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
mr2d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_acc_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the 2D Mental Rotation Task after 1 year of study")

# Does Accuracy on the 2D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
mr2d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_acc_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 2D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the 2D Mental Rotation Task after 2 years of study")
```
###### Correlations
```{r}
mr2d_acc_grade_terp_wide %>% 
  filter(`mr2d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_pre-degree`, 
                       `grade_terp_1st year`))

mr2d_acc_grade_terp_wide %>% 
  filter(`mr2d_acc_1st year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_1st year`, 
                       `grade_terp_1st year`))

mr2d_acc_grade_terp_wide %>% 
  filter(`mr2d_acc_2nd year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>%   summarize(AccCOR=cor(`mr2d_acc_2nd year`, 
                       `grade_terp_1st year`))

mr2d_acc_grade_terp_wide %>% 
  filter(`mr2d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_pre-degree`, 
                       `grade_terp_2nd year`))

mr2d_acc_grade_terp_wide %>% 
  filter(`mr2d_acc_1st year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`mr2d_acc_1st year`, 
                       `grade_terp_2nd year`))

mr2d_acc_grade_terp_wide %>% 
  filter(`mr2d_acc_2nd year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>%   summarize(AccCOR=cor(`mr2d_acc_2nd year`, 
                       `grade_terp_2nd year`))
```


##### RT 
```{r mr2d_rt_grade_terp}
# Create wider pivot table
mr2d_rt_grade_terp_wide <- apt %>% 
  select(session, group, ppt, mr2d_rt, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr2d_rt, grade_terp))

# Does Reaction Time on the 2D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 1st year?
mr2d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_rt_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 1st year?
mr2d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_rt_1st year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 1 year of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 1st year?
mr2d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_rt_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 2nd year?
mr2d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_rt_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
mr2d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_rt_1st year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 1 year of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Reaction Time on the 2D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
mr2d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr2d_rt_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title = "Does Reaction Time on the 2D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

###### Correlations
```{r}
mr2d_rt_grade_terp_wide %>% 
  filter(`mr2d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_pre-degree`, 
                       `grade_terp_1st year`))

mr2d_rt_grade_terp_wide %>% 
  filter(`mr2d_rt_1st year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_1st year`, 
                       `grade_terp_1st year`))

mr2d_rt_grade_terp_wide %>% 
  filter(`mr2d_rt_2nd year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>%   summarize(rtCOR=cor(`mr2d_rt_2nd year`, 
                       `grade_terp_1st year`))

mr2d_rt_grade_terp_wide %>% 
  filter(`mr2d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_pre-degree`, 
                       `grade_terp_2nd year`))

mr2d_rt_grade_terp_wide %>% 
  filter(`mr2d_rt_1st year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(rtCOR=cor(`mr2d_rt_1st year`, 
                       `grade_terp_2nd year`))

mr2d_rt_grade_terp_wide %>% 
  filter(`mr2d_rt_2nd year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>%   summarize(rtCOR=cor(`mr2d_rt_2nd year`, 
                       `grade_terp_2nd year`))
```

#### 3D Mental Rotation vs Interpreting Grades
##### Accuracy 
```{r mr3d_acc_grade_terp}
# Create wider pivot table
mr3d_acc_grade_terp_wide <- apt %>% 
  select(session, group, ppt, mr3d_acc, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr3d_acc, grade_terp))

# Does Accuracy on the 3D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 1st year?
mr3d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_acc_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title = "Does Accuracy on the 3D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the 3D Mental Rotation Task pre-degree")

# Does Accuracy on the 3D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 1st year?
# mr3d_acc_grade_terp_wide %>%
#  ggplot(aes(x = `mr3d_acc_1st year`, y = `grade_terp_1st year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()  # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Accuracy on the 3D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 1st year?
mr3d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_acc_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Accuracy on the 3D Mental Rotation Task after 2 years")

# Does Accuracy on the 3D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 2nd year?
mr3d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_acc_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  geom_point() +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the 3D Mental Rotation Task pre-degree") 

# Does Accuracy on the 3D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
# mr3d_acc_grade_terp_wide %>%
#  ggplot(aes(x = `mr3d_acc_1st year`, y = `grade_terp_2nd year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()  # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Accuracy on the 3D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
mr3d_acc_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_acc_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1L)) +
  theme_minimal() +
  labs(title= "Does Accuracy on the 3D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Accuracy on the 3D Mental Rotation Task after 2 years") 

```
###### Correlations
```{r}
mr3d_acc_grade_terp_wide %>% 
  filter(`mr3d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(AccCOR=cor(`mr3d_acc_pre-degree`, 
                       `grade_terp_1st year`))

mr3d_acc_grade_terp_wide %>% 
  filter(`mr3d_acc_2nd year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>%   summarize(AccCOR=cor(`mr3d_acc_2nd year`, 
                       `grade_terp_1st year`))

mr3d_acc_grade_terp_wide %>% 
  filter(`mr3d_acc_pre-degree`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(AccCOR=cor(`mr3d_acc_pre-degree`, 
                       `grade_terp_2nd year`))

mr3d_acc_grade_terp_wide %>% 
  filter(`mr3d_acc_2nd year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>%   summarize(AccCOR=cor(`mr3d_acc_2nd year`, 
                       `grade_terp_2nd year`))
```

##### RT 
```{r mr3d_rt_grade_terp}
# Create wider pivot table
mr3d_rt_grade_terp_wide <- apt %>% 
  select(session, group, ppt, mr3d_rt, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(mr3d_rt, grade_terp))

# Does Reaction Time on the 3D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 1st year?
mr3d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_rt_pre-degree`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal()+
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Reaction Time on the 3D Mental Rotation Task pre-degree") 

# Does Reaction Time on the 3D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 1st year?
# mr3d_rt_grade_terp_wide %>%
#  ggplot(aes(x = `mr3d_rt_1st year`, y = `grade_terp_1st year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()  # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Reaction Time on the 3D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 1st year?
mr3d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_rt_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal()+
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 1st year?", y = "1st year Interpreting grade", x = "Reaction Time on the 3D Mental Rotation Task after 2 year of study") 

# Does Reaction Time on the 3D Mental Rotation Task pre-degree predict Interpreting Grades at the end of 2nd year?
mr3d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_rt_pre-degree`, y = `grade_terp_2nd year`)) +
  geom_smooth(method= "lm") +
  geom_point() +
  theme_minimal()+
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task pre-degree\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Reaction Time on the 3D Mental Rotation Task pre-degree") 

# Does Reaction Time on the 3D Mental Rotation Task after 1 year of study predict Interpreting Grades at the end of 2nd year?
# mr3d_rt_grade_terp_wide %>%
#  ggplot(aes(x = `mr3d_rt_1st year`, y = `grade_terp_2nd year`)) +
#  geom_point() +
#  geom_smooth(method= "lm") +
#  theme_minimal()   # removing bc only 2 datapoints for 3DMR @ timepoint 2

# Does Reaction Time on the 3D Mental Rotation Task after 2 years of study predict Interpreting Grades at the end of 2nd year?
mr3d_rt_grade_terp_wide %>%
  ggplot(aes(x = `mr3d_rt_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Reaction Time on the 3D Mental Rotation Task after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = "Reaction Time on the 3D Mental Rotation Task after 2 years of study") 
```

###### Correlations
```{r}
mr3d_rt_grade_terp_wide %>% 
  filter(`mr3d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>% 
  summarize(rtCOR=cor(`mr3d_rt_pre-degree`, 
                       `grade_terp_1st year`))

mr3d_rt_grade_terp_wide %>% 
  filter(`mr3d_rt_2nd year`!= "NA") %>% 
  filter(`grade_terp_1st year` != "NA") %>%   summarize(rtCOR=cor(`mr3d_rt_2nd year`, 
                       `grade_terp_1st year`))

mr3d_rt_grade_terp_wide %>% 
  filter(`mr3d_rt_pre-degree`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>% 
  summarize(rtCOR=cor(`mr3d_rt_pre-degree`, 
                       `grade_terp_2nd year`))

mr3d_rt_grade_terp_wide %>% 
  filter(`mr3d_rt_2nd year`!= "NA") %>% 
  filter(`grade_terp_2nd year` != "NA") %>%   summarize(rtCOR=cor(`mr3d_rt_2nd year`, 
                       `grade_terp_2nd year`))
```

#### Barratt Impulsiveness Scale vs Interpreting Grades

##### Total Impulsiveness 
```{r bis_tot_grade_terp}
# Create wider pivot table
bis_tot_grade_terp_wide <- apt %>% 
  select(session, group, ppt, bis_tot, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_tot, grade_terp))

# Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study predict Interpreting Grades at the end of 1st year?
bis_tot_grade_terp_wide %>%
  filter(`bis_tot_2nd year` != "na") %>% 
  filter(`grade_terp_1st year` != "na") %>% 
  ggplot(aes(x = `bis_tot_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study predict Interpreting Grades at the end of 2nd year?
bis_tot_grade_terp_wide %>%
  filter(`bis_tot_2nd year` != "na") %>% 
  filter(`grade_terp_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_tot_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Total Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

Not sure why geom_smooth() line does not appear in knitted output (works in .Rmd file)

##### Attentional Impulsiveness
```{r bis_att_grade_terp}
# Create wider pivot table
bis_att_grade_terp_wide <- apt %>% 
  select(session, group, ppt, bis_att, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_att, grade_terp))

# Does Attentional Impulsiveness after 2 years predict Interpreting Grades at the end of 1st year?
bis_att_grade_terp_wide %>%
  filter(`bis_att_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_att_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Attentional Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Attentional Impulsiveness after 2 years predict Interpreting Grades at the end of 2nd year?
bis_att_grade_terp_wide %>%
  filter(`bis_att_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_att_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Attentional Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Motor Impulsiveness
```{r bis_nplan_grade_terp}
# Create wider pivot table
bis_nplan_grade_terp_wide <- apt %>% 
  select(session, group, ppt, bis_nplan, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_nplan, grade_terp))

# Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict Interpreting Grades at the end of 1st year?
bis_nplan_grade_terp_wide %>%
  filter(`bis_nplan_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_nplan_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict Interpreting Grades at the end of 2nd year?
bis_nplan_grade_terp_wide %>%
  filter(`bis_nplan_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_nplan_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Motor Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```

##### Non-Planning Impulsiveness
```{r bis_mot_grade_terp}
# Create wider pivot table
bis_mot_grade_terp_wide <- apt %>% 
  select(session, group, ppt, bis_mot, grade_terp) %>% 
  tidyr::pivot_wider(
    names_from = session,
    values_from = c(bis_mot, grade_terp))

# Does Non-PLanning Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict Interpreting Grades at the end of 1st year?
bis_mot_grade_terp_wide %>%
  filter(`bis_mot_2nd year` != "NA") %>% 
  ggplot(aes(x = `bis_mot_2nd year`, y = `grade_terp_1st year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Non-Planning Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")

# Does Non-PLanning Impulsiveness on the Barratt Impulsiveness Scale after 2 years predict Interpreting Grades at the end of 2nd year?
bis_mot_grade_terp_wide %>%
  filter(`bis_mot_2nd year` != "na") %>% 
  ggplot(aes(x = `bis_mot_2nd year`, y = `grade_terp_2nd year`)) +
  geom_point() +
  geom_smooth(method= "lm") +
  theme_minimal() +
  labs(title= "Does Non-Planning Impulsiveness on the Barratt Impulsiveness Scale after 2 years of study\npredict Interpreting Grades at the end of 2nd year?", y = "2nd year Interpreting grade", x = " ")
```
#########################################################################
#########################################################################

# Factor Analysis

reduce tibble to just independent variables:
``` {r reduce_tibble}
# apt <- select(apt, -session, - group, -ppt, -copy_score, -srt_score, -town_map, -bsl_grade)
```

filter out rows with incomplete data
``` {r filter_rows}
#apt_reduced <- filter(apt, corsi_corr != "na")
#apt_reduced <- filter(apt_reduced, nback_spat != "na")
#apt_reduced <- filter(apt_reduced, kirk_ceil != "na")
```

reduce to just four tasks that were done at all 3 sessions
```{r}
#apt_reduced <- select(apt_reduced, nback_lett:kbit_acc)
```

## FA using psych package

```{r }
# fapsych <- fa(apt_reduced, nfactors=3, rotate="oblimin", scores="regression", residuals=FALSE, fm="minres")
```

## run FA using factanal package
``` {r}
# FA <- factanal(apt_reduced, factors=2, rotation="varimax", scores="regression")
```
